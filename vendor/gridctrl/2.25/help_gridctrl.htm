
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>


<!-- START Insight XE--> 
<script language="JavaScript"> 
var if_Site_ID = "ipro"; 
var if_sid="1"; 
var if_protocol=window.location.protocol; 
var mep1="&Site="+escape("codeproject.com"); 
</script> 
<SCRIPT LANGUAGE="JavaScript" SRC="http://a248.e.akamai.net/7/836/1132/102403/ipro.247realmedia.com/scripts/ipro_if.js"></SCRIPT> 
<!-- END Insight XE--> 


<title>MFC Grid control 2.25 - The Code Project - Miscellaneous Controls</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<META NAME="MS.LOCALE"          content="en-US" />
<meta NAME="Description"        content="A fully featured MFC grid control for displaying tabular data. The grid is a custom control derived from CWnd" />
<meta name="Search.TopicType"   content="kbArticle" />
<meta name="Author"             content="Chris Maunder" />
<meta name="Search.PublishDate" content="16 Nov 1999 14:00:00 GMT" />
<meta name="Search.RevisedDate" content="12 Mar 2004 14:00:00 GMT" />

<!--<meta name="Search.UserRating"  content="86 %" /> -->
<meta NAME="keywords" Content="Free source code, Miscellaneous Controls, Visual C++, MFC, Windows, Grid Control, MFC">
<meta NAME="Copyright" CONTENT="Article content copyright Chris Maunder, 1999, everthing else Copyright © CodeProject, 1999-2005, All Rights Reserved.">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All topics" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - MFC / C++" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - ASP.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - .NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5">
<meta http-equiv="Reply-to" CONTENT="mailto:webmaster@codeproject.com">
<link rel="icon" href="/favicon.ico" type="image/ico">
<link rel="SHORTCUT ICON" href="/favicon.ico">

<link rel="stylesheet" type=text/css href="/styles/global.css">
<script language="javascript" src="/script/oncopy.js"></script>
<link rel="stylesheet" type=text/css href="/styles/netscape6.css">

</head>
<body text=black bgColor=white aLink=red link=blue vLink=purple topmargin=3 leftmargin=3 
      oncopy="return copyCode();">



<table bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=0 width='100%'>
<tr><td width="100%">
<table bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=1 width="100%"><tr>

<td valign=top><a href="http://www.codeproject.com">
<img border=0 width=225 height=72 src="/images/standard/logo225x72.gif" alt="The Code Project"></a></td>
<td align=right><span id=AdBanner4><table cellspacing=0 cellpadding=0><tr><td><a class=AdLink href='/script/admentor/ads.asp'>View our advertisers</a></td><td align=right><a class=AdLink href='/info/mediakit'>Advertise with us</a></td></tr><td colspan=2><script language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=402&way=ban\" target=_blank><img src=\"/script/admentor/include/ServeAd.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvsnet468x60%5Fmfc%2Egif&C=False&id=402\" alt=\"Support Code Project and purchase Visual Studio .NET from $899\" border=0 width=468 height=60></a>");</script></td></tr></table></span></td>

</tr>

<tr><td colspan=2 bgcolor=#FBEDBB>
<table cellpadding=3 width=100% border=0 bgcolor=#FBEDBB>

<tr valign=top>
	<td width=100%>
		<font style="font-size:8pt"><a href='/?cat=1'>All Topics</a>, <a href='/?cat=2'>MFC / C++</a> &gt;&gt; <a href='/miscctrl/'>Miscellaneous Controls</a> &gt;&gt; <a href='/miscctrl/#Grid+Control'>Grid Control</a></font><br>

		<br><b><font size=4 style="font-size:16pt">MFC Grid control 2.25</font></b><br><b>
		By <a href="/script/profile/whos_who.asp?id=1">Chris Maunder</a>
		</b>
		<br><br><font style="font-size:9pt">A fully featured MFC grid control for displaying tabular data. The grid is a custom control derived from CWnd&nbsp;</font>
	</td>
	<td align=right valign=top>
		<table border=0 cellspacing=0 cellpadding=1 width=200>	

		<tr valign=top><td>&nbsp;</td><td class=SmallText>C++ (VC7, VC5, VC6)<br> Windows (NT4, Win2K, Win95, Win98), WinCE (CE 2.0, CE 2.10, CE 2.11)<br> Win32, VS, MFC<br> Dev</td></tr>
		<tr><td>&nbsp;</td><td nowrap class=SmallText>Posted 17 Nov 1999 0:00</td></tr>

		<tr><td>&nbsp;</td><td class=SmallText>Updated 13 Mar 2004 0:00</td></tr>
	
		<tr valign=top><td><img src="/images/hlp.gif" width=16 height=16></td><td nowrap class=SmallText><a href='/script/Articles/list_articles.asp?userid=1'>Articles by this author</a></td></tr>

		<tr valign=top><td></td><td nowrap class=SmallText><b>1,222,675</b> views</td></tr>

		</table>
	</td>
</tr>


</table>
</td></tr>

<tr><td colspan=2>



<TABLE BORDER=0 CELLPADDING=1 CELLSPACING=0 width=100% id=tblSiteToolbar><TR>
<form method="post" action="/info/search.asp" name="Search">
<TD VALIGN=top ALIGN=left width=100%>
<TABLE BORDER="0" CELLPADDING="1" CELLSPACING="0"><TR VALIGN=center>
<td class=smallText><b><font color=white>Search:</font></b></td>
<TD class=navbar nowrap><input class=smallText name="target" 

size="10"

maxlength="255"></TD><td valign=top><select class=smallText name=st>
<option value="kw">Articles</option>
<option value="au">Authors</option>
</select></td>
<TD><INPUT class=formButton type="submit" value="Go"></TD>
</TR></TABLE></td>
</FORM>


<TD>
<div id='MenuPos' style='position:relative;width:380;height:20;'>

<table width=375 cellpadding=2 cellspacing=0 height=20><tr>
<td><A href='/info/faq.asp' class=NavMenuItem>Help!</a></td>
<td><A href='/info/latest.asp' class=NavMenuItem>Articles</td>
<td><A href='/script/comments/forums.asp' class=NavMenuItem>Message Boards</td>
<td><A href='/store/' class=NavMenuItem>StoreFront</td>
<td><A href='/lounge.asp' class=NavMenuItem>Lounge</td>
</tr></table>
</div>
</td>


</TR></table>


<script type='text/javascript'>function Go(){return}</script>
<script type='text/javascript' src='/script/HVMenu/cpmenu_var.js'></script>
<script type='text/javascript' src='/script/HVMenu/menu10_com.js'></script>

</td></tr>

</table></td></tr></table>

<table cellspacing=0 cellpadding=1 border=0>

<tr valign=top>
	<td rowspan=2 valign=top bgcolor=#FBEDBB>
	<table border=0 cellspacing=0 cellpadding=0>
		

<script language=javascript>
function ErrorHandle() {}
window.onerror = ErrorHandle;

function OnNLSubmit(option)
{
	if (option=="up")
		document.subForm.action = "/script/profile/modify.asp?ct=%2Fmiscctrl%2Fgridctrl%2Easp";
	else if (option=="in")
		document.subForm.action = "/script/profile/process_logon.asp?ct=%2Fmiscctrl%2Fgridctrl%2Easp";
	document.subForm.submit();
	return true;
}
</script>


<tr><td>
<table cellspacing=3 cellpadding=0>
<tr valign=top><td></td><td></td></tr><tr valign=top><td></td><td class=InfoBarHeader>Toolbox</td></tr><tr><td colspan=2 bgcolor=black><img src='/images/space.gif' height=1 width=1></td></tr><tr valign=top><td><img src=/script/images/sitebuild_icon.gif width=16 height=16></td><td class=smallText><a href="/script/submit/ReportProblem.asp?GUID=%2Fmiscctrl%2Fgridctrl%2Easp">Broken Article?</a></td></tr><tr valign=top><td></td><td></td></tr><tr valign=top><td><img src=/script/images/support_icon.gif width=16 height=16></td><td class=smallText><A HREF='/store/'><b>VS.NET 2003 for $899</b></A></td></tr><tr valign=top><td><img src=/script/images/support_icon.gif width=16 height=16></td><td class=smallText><A HREF='/store/'><b>Ultimate Toolbox $499</b></A></td></tr><tr valign=top><td></td><td></td></tr><tr valign=top><td><img src=/images/print.gif width=16 height=16></td><td class=smallText><a href='/miscctrl/gridctrl.asp?print=true' target=_print>Print version</a></td></tr>
<tr valign=top>	
      <td><img src="/images/mail.gif" width=16 height=16></td>
      <td class=SmallText><a href='/script/recommend/form.asp?guid=%2Fmiscctrl%2Fgridctrl%2Easp'>Send to a friend</a></td>
</tr>
<tr valign=top><td></td><td></td></tr><tr><td colspan=2 bgcolor=black><img src='/images/space.gif' height=1 width=1></td></tr><tr valign=top><td colspan=2 class=InfoBarHeader><br>Sign in / Sign up</td></tr>
</table></td></tr>

<tr><td class=smallText>
<form name="subForm" id=subForm action="/script/profile/process_logon.asp" method=post>
<table width=125 border=0 cellpadding=0 cellspacing=0 bgcolor=#ffcc99>
	<tr><td colspan=2><img src='/images/space.gif' height=3></td></tr>

	<tr>
		<td class=smallText>&nbsp;Email</td>
		<td class=smallText><input class=smallText type="text" name="Email" id="Email" size=3>
		</td>
	</tr>
	<tr>
		<td class=smallText>&nbsp;Password</td>
		<td><input class=smallText type="password" name="Password" id="Password" size=3></td>
	</tr>
	<tr>
		<td colspan=2 class=smallText valign=middle><input type=checkbox checked name=cookie>Remember me</td>
	</tr>
	<tr><td colspan=2><img src='/images/space.gif' height=3></td></tr>


	<tr>
		<td align=center><a href='/script/profile/modify.asp'><img border=0 src="/images/signup.gif"></a></td>
		<td align=center><input border=0 type="image" src="/images/signin.gif"></td>
	</tr>


	<tr><td colspan=2><img src='/images/space.gif' height=3></td></tr>
</form></table>
</td></tr>

<tr><td class=smallText><a class=smallText href="/script/profile/forgot.asp" name='HLLink'>Lost your Password?</a></td></tr>

		<tr><td>&nbsp;</td></tr>
		<tr><td>
		
<center><script language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1052&way=ban\" target=_blank><img src=\"/script/admentor/include/ServeAd.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FUltimateToolbox120x600%2Egif&C=False&id=1052\" alt=\"Ultimate Toolbox 9.0 - MFC 7.0 Compliant, with Office 2003 like and Office XP like classes and hundreds more, all with 100% MFC source code\" border=0 width=120 height=600></a>");</script><br>

</center><br>

		</td></tr>
	</table>
	</td>
	<td width=5 rowspan=2>
		<img src='/images/space.gif' width=5 height=1>	
	</td>



	<td width=100% align=right bgcolor=white>


<table width=100%><tr valign=top><td nowrap valign=top class=smallText></td>
<td align=right nowrap><a name="__top"></a><table><tr><td align=right class=smallText>709 members have rated this article. Result:</td><td>
<table border="2" cellpadding="0" cellspacing="0"><tr>
<td><img src='/script/images/red.gif' width='20' height='5' border='0'></td>
<td><img src='/script/images/red.gif' width='20' height='5' border='0'></td>
<td><img src='/script/images/red.gif' width='20' height='5' border='0'></td>
<td><img src='/script/images/red.gif' width='20' height='5' border='0'></td>
<td><img src='/script/images/red.gif' width='17' height='5' border='0'><img src='/script/images/white.gif' width='3' height='5' border='0'></td>
</tr></table>
</td></tr><tr><td colspan=2 align=right class=smallText><a href='/script/articles/top_articles.asp?st=2' title='Calculated as rating x Log10(# votes)'>Popularity: 13.76</a>. Rating: <b>4.83</b> out of 5.</td></tr></table></td></tr></table>

	</td>
</tr>
<tr>
	<td width=100% valign=top>

<div id="contentdiv">


<!-- Article Starts -->


<UL class=download>
<LI><A href="gridctrl/gridctrl_demo225.zip">Download demo project (v2.25) - 278 Kb</A> 
<LI class=download><A href="gridctrl/gridctrl_src.zip">Download source (v2.25) - 99 Kb</A> </LI></UL>
<P><IMG height=228 alt="gridctrl example image" src="gridctrl/gridctrl.gif" width=341 align=bottom border=0> 
<H2>Preface</H2>
<P>This grid is the work of thousands of hours of squinting at pixels, hunting memory leaks, adding new features, fixing new bugs and beating the code by force of will into a form that is as feature rich and useable as something of this form can be. Dozens of developers from all over the world have contributed fixes, improvements and suggestions over the 4 years that the grid has been growing, and there is still no end in sight. Most of the fixes have been sent in by readers so I'm trusting that they have done sufficient testing.</P>
<P>Release 2.25 is a minor update of 2.24 for Visual C++ .NET 2003 / Whidbey. It includes a few bug fixes and behavioral updates as well as some visual enhancements and speed improvements. For a full list of changes for version 2.25 click <A href="#New">here</A>.</P>
<H2>Contents</H2>
<TABLE cellSpacing=0 cellPadding=0 width="90%">
<TBODY>
<TR>
<TD vAlign=top>
<UL>
<LI><A href="#Introduction">Introduction</A> 
<LI><A href="#Structure">Structure</A> 
<LI><A href="#Overrides">Protected overridable functions</A> 
<LI><A href="#Clipboard">Clipboard</A> 
<LI><A href="#Sorting">Sorting</A> 
<LI><A href="#Virtual">Virtual Mode</A> 
<LI><A href="#Acknowledgements">Acknowledgements</A> </LI></UL></TD>
<TD vAlign=top>
<UL>
<LI><A href="#Appearance">General appearance and features</A> 
<LI><A href="#Files">Files</A> 
<LI><A href="#Constuction">Construction</A> 
<LI><A href="#NumRowsCols">Number of rows and columns</A> 
<LI><A href="#Sizing">Sizing and position functions</A> 
<LI><A href="#EditValidate">Cell Editing and Validation</A> </LI></UL></TD>
<TD vAlign=top>
<UL>
<LI><A href="#Structures">Structures, defines and Messages</A> 
<LI><A href="#Colours">Colours</A> 
<LI><A href="#CellInfo">General cell information</A> 
<LI><A href="#Operations">Operations</A> 
<LI><A href="#Printing">Printing</A> 
<LI><A href="#History">History</A> </LI></UL></TD></TR></TBODY></TABLE>
<H2><A name=Introduction>Introduction</A></H2>
<P>After pushing the <CODE>CListCtrl</CODE> to its limits in trying to display and edit tabulated data I decided what was really needed was a dedicated grid control. I started writing my own grid control from scratch but decided to save time by modifying <A href="mailto:chinajoe@aol.com">Joe Willcoxson's</A> free WorldCom grid control at <A href="http://users.aol.com/chinajoe/wcmfclib.html">http://users.aol.com/chinajoe/wcmfclib.html</A>. I tore apart his code and rebuilt it from the ground up in order to get it to do all the things I needed. The code has gone through so many modifications that I'm not sure if there is even a single original line of code. In any case Joe's code was a great framework on which to build. 
<P>The project started out as a simple clean up but very quickly ballooned into a bit of a nightmare as I kept finding new features that I felt just <I>had</I> to go into it. It has not been tested exhaustively - but I'm fairly confident that it won't fall over too badly :). Joe was kind enough to allow me to release the source with no strings attached (since it is based on his code) but since the project was such a marathon I am placing a couple of very minor conditions on the use of this code: 
<BLOCKQUOTE style="BACKGROUND-COLOR: #fbedbb"><I>
<P>This code may be used in compiled form in any way you desire (including commercial use). The code may be redistributed unmodified by any means <B>providing</B> it is not sold for profit without the authors written consent, and providing that this notice and the authors name and all copyright notices remains intact. However, this file and the accompanying source code <B>may not</B> be hosted on a website or bulletin board without the authors written permission.</P>
<P><B>This software is provided "as is" without express or implied warranty. Use it at your own risk!</B></P>
<P>Whilst I have made every effort to remove any undesirable "features", I cannot be held responsible if it causes any damage or loss of time or data.</P></I></BLOCKQUOTE>Hopefully that isn't too much to ask considering the amount of work that went into this. If you <I>do</I> use it in a commercial application then <B>please</B> send me an <A href="mailto:cmaunder@mail.com">email</A> letting me know. There's no point in me releasing and maintaining/upgrading this thing if no one is gonna use it. 
<P>The control features: 
<UL>
<LI>Cell selection using the mouse, with optional Control and Shift key combinations. Selection can be disabled. 
<LI>Row and Column resizing. Sizing can be disabled for row, columns or both. 
<LI>Auto row or column sizing when dividers are double-clicked. 
<LI>Any number of fixed rows and columns. 
<LI>Individual cells can have separate text and background colours. 
<LI>Individual cells can have separate fonts. 
<LI>Individual cells can be marked "Read-Only", or have their modification status set and checked. 
<LI>OLE Drag and drop. 
<LI>Ctrl-C, Ctrl-X and Ctrl-V perform clipboard copy, cut and paste, and Ctrl-A for "Select All" 
<LI>In place editing of cell contents. If a character key is pressed while a cell has focus, editing will start on that cell, and the arrow keys will allow navigation to other keys. If the current focus cell is clicked on, editing will start and the arrow keys will move the carat inside the edit control. Editing can be disabled. 
<LI>Support for Microsoft intellimouse. 
<LI>Optional grid lines. 
<LI>Images in any cell 
<LI>"Virtual" mode for large datasets 
<LI>Full printing support, for either a Doc/View environment (inc Print preview) or a standalone dialog based app (no print preview). 
<LI>Optional "List mode", including full row selection, single row selection, and sort on column header click. 
<LI>Numerous virtual functions to allow this control to be extended very easily. 
<LI>Unicode support. 
<LI>WinCE support 
<LI>Titletips for cells that are too small to display their data. 
<LI>Hidden rows and columns 
<LI>Compiles under VC 4.2, 5.0, 6.0 and under the CE toolkit version 2.0 and 3.0 </LI></UL>The <A href="gridctrl/gridctrl_demo224.zip">sample project</A> demonstrates most of the features of the grid control. 
<H2><A name=Files>Files</A></H2>
<P>To use the Grid control in your project you will need to add a number of files to your project: <BR><BR>
<BLOCKQUOTE>
<TABLE cellSpacing=0 width="90%">
<TBODY>
<TR vAlign=top>
<TD><CODE>gridctrl.cpp, gridctrl.h</CODE></TD>
<TD>Main grid control source and header files.</TD></TR>
<TR>
<TD><CODE>gridcellbase.cpp, gridcellbase.h</CODE></TD>
<TD>Main grid cell base class.</TD></TR>
<TR>
<TD><CODE>gridcell.cpp, gridcell.h</CODE></TD>
<TD>Main grid cell default class implementation.</TD></TR>
<TR vAlign=top>
<TD><CODE>CellRange.h</CODE></TD>
<TD>Definition of CCellID and CCellRange helper classes.</TD></TR>
<TR vAlign=top>
<TD><CODE>MemDC.h</CODE></TD>
<TD><A href="keithr@europa.com">Keith Rule</A>'s memory DC helper class.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>InPlaceEdit.cpp, InPlaceEdit.h</CODE></TD>
<TD>In-place edit windows source and header files.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>GridDropTarget.cpp, GridDropTarget.h</CODE></TD>
<TD>Grid control OLE drag and drop target. Only necessary if you don't define GRIDCONTROL_NO_DRAGDROP in gridctrl.h</TD></TR>
<TR vAlign=top>
<TD width="45%"><CODE>Titletip.cpp, Titletip.h</CODE></TD>
<TD width="50%">Titletips for cells, from Zafir Anjum. Only necessary if you don't define GRIDCONTROL_NO_TITLETIPS in gridctrl.h</TD></TR></TBODY></TABLE></BLOCKQUOTE><A name=Structure></A>
<H2>Structure</H2>
<P>The grid is based on a framework (the <CODE>CGridCtrl</CODE> object) that organises and controls a collection of cells (<CODE>CGridBaseCell</CODE>) that contain the data, perform operations such as drawing, and handle methods such as button clicks. The grid object itself handles events such as button clicks before the cells get a chance, and will pass on certain mouse messages if it considers it necessary. The grid also contains a drag and drop target (<CODE>CGridDropTarget</CODE>) that is registered to handle drop notifications, and there is also a title tip object (<CODE>CTitleTip</CODE>) that displays the contents of cells when the physical dimensions of a cell are insufficient to display its' contents in their entirety. 
<P>The grid cells can be of any type as long as the class is derived from <CODE>CGridBaseCell</CODE>. Included with the package is a <CODE>CGridCell</CODE> class that handles basic data storage and editing. Extensions such as the <CODE>CGridCellCombo</CODE> and <CODE>CGridURLCell</CODE> class demonstrate how to create your own cell classes. 
<P>There are two main types of cell - fixed and non-fixed. Fixed cells are typically on the left and top of the grid and do not move when the grid is scrolled. Typically these contain column and row headings and are not editable. Non fixed cells make up the "interior" of the grid and can be edited and selected. 
<P>Default values for various properties of the grid are stored in <CODE>CGridDefaultCell</CODE> objects. There are currently 4 of these objects per grid - one each to hold default values for the non-fixed cells, fixed columns, foxed rows, and cells that are both fixed rows and columns cells. Thus in order to set a default property for the grid, use <CODE>CGridCtrL::GetDefaultCell</CODE> to get the default cell implementation you are after, then set it's values directly. 
<P>Cells hold their property values explicitely, except for the font property. Each cell holds a pointer to a font structure, and this pointer is only allocated and used if you set that cell's font to a non-default value. 
<P>The grid also has a <B>virtual mode</B> that stops the grid from actually creating cells, and allows you to specify either a callback funtion or message handler that the grid will call each time it needs information on a cell. This saves enourmously on memory at the expense of slightly decreased performance. There is a <CODE>GVN_ODCACHEHINT</CODE> message that is sent to the grid's parent that will help you cache data in preparation for the grid's cell info requests. 
<P>Grid cells are stored row-by-row, so all operations on large numbers of cells should be done row-by-row as well. 
<H2><A name=Constuction>Construction</A></H2>
<P>OK - so how do you use it? 
<P>The underlying class of the grid control is <CODE>CGridCtrl</CODE> which is derived from <CODE>CWnd</CODE>. To use it, either use the MS Visual C++ dialog editor to place a custom control on a dialog, and enter "MFCGridCtrl" (no quotes) as the Class name. To subclass the control using the <CODE>DDX</CODE> mechanism (this will be done by default by the ClassWizard) use the <CODE>DDX_GridControl</CODE> function instead of the <CODE>DDX_Control</CODE> function (just manually change the ClassWizard entry). This ensures your control is correctly registered as a drop target and avoids some weird win95 issues. 
<P>Alternatively you can use <CODE>CGridCtrl::Create</CODE>: </P><PRE>CGridCtrl grid;
grid.Create(rect, pParentWnd, nID);</PRE>where <I>rect</I> is the dimensions, <B>pParentWnd</B> is the parent window, and <I>nID</I> is the id. 
<H2><A name=NumRowsCols>Number of rows and columns</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetRowCount() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the number of rows (including fixed rows)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetColumnCount() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the number of columns (including fixed columns)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetFixedRowCount() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText vAlign=top width="100%">Returns the number of fixed rows</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetFixedColumnCount() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the number of fixed columns</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetRowCount(<span class='cpp-keyword'>int</span> nRows)</CODE> </TD>
<TD class=smallText width="100%">Sets the number of rows (including fixed rows), Returning TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetColumnCount(<span class='cpp-keyword'>int</span> nCols)</CODE> </TD>
<TD class=smallText width="100%">Sets the number of columns (including fixed columns), Returning TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetFixedRowCount(<span class='cpp-keyword'>int</span> nFixedRows = <span class='cpp-literal'>1</span>)</CODE> </TD>
<TD class=smallText width="100%">Sets the number of fixed rows, returning TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetFixedColumnCount(<span class='cpp-keyword'>int</span> nFixedCols = <span class='cpp-literal'>1</span>)</CODE> </TD>
<TD class=smallText width="100%">Sets the number of columns, returning TRUE on success.</TD></TR></TBODY></TABLE>
<H2><A name=Sizing>Sizing and position functions</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetRowHeight(<span class='cpp-keyword'>int</span> nRow) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the height of row nRow.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetRowHeight(<span class='cpp-keyword'>int</span> row, <span class='cpp-keyword'>int</span> height)</CODE> </TD>
<TD class=smallText width="100%">Sets the height of row nRow.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetColumnWidth(<span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the width of column nCol</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetColumnWidth(<span class='cpp-keyword'>int</span> col, <span class='cpp-keyword'>int</span> width)</CODE> </TD>
<TD class=smallText width="100%">Sets the width of column nCol.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetFixedRowHeight() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the combined height of the fixed rows.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetFixedColumnWidth() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the combined width of the fixed columns.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>long</span> GetVirtualHeight() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the combined height of all the rows.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>long</span> GetVirtualWidth() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the combined width of all the columns.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetCellOrigin(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPPOINT p)</CODE> </TD>
<TD class=smallText width="100%">Gets the topleft point for cell (nRow,nCol), returning TRUE if successful. (cell must be visible for success).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetCellOrigin(<span class='cpp-keyword'>const</span> CCellID&amp; cell,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPPOINT p)</CODE> </TD>
<TD class=smallText width="100%">Gets the topleft point for the given cell, returning TRUE if successful. (cell must be visible for success). See also <A href="#CCellID">CCellID</A><A>.</A></TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetCellRect(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPRECT pRect)</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the given cell, returning TRUE if successful. (cell must be visible for success).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetCellRect(<span class='cpp-keyword'>const</span> CCellID&amp; cell,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPRECT pRect)</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the given cell, returning TRUE if successful. (cell must be visible for success). See also <A href="#CCellID">CCellID</A><A>.</A></TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetTextRect(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPRECT pRect)t</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the text in the given cell, returning TRUE if successful. (cell must be visible for success).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetTextRect(<span class='cpp-keyword'>const</span> CCellID&amp; cell,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPRECT pRect)</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the text in the given cell, returning TRUE if successful. (cell must be visible for success). See also <A href="#CCellID">CCellID</A><A>.</A></TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetTextExtent(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPCTSTR str)</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the given text for the given cell, returning TRUE if successful.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetCellTextExtent(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Gets the bounding rectangle for the text in the given cell, returning TRUE if successful.</TD></TR></TBODY></TABLE>
<H2><A name=Virtual>Virtual Mode</H2></A>
<P>Virtual mode allows you to use the grid to display large amounts of data without requiring the grid to actually store this data. In Virtual Mode, no cells are created and no data is stored other than the widths and heights of columns and rows. 
<P>Since the data is not stored by the grid, the grid must have some way of asking the application to supply it with data. This is done either by either registering a callback function with the grid, or by having the parent handle a <CODE>GVN_GETDISPINFO</CODE> notification.</P>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetVirtualMode(BOOL bVirtual)</CODE></TD>
<TD class=smallText width="100%">Places the grid in or out of virtual mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetVirtualMode()</CODE></TD>
<TD class=smallText width="100%">Returns TRUE if the grid is in virtual mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetCallbackFunc(GRIDCALLBACK pCallback,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPARAM lParam) </CODE></TD>
<TD class=smallText width="100%">Sets the callback function for when the grid is in virtual mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>GRIDCALLBACK GetCallbackFunc() </CODE></TD>
<TD class=smallText width="100%">Returns the callback function when the grid is in virtual mode.</TD></TR></TBODY></TABLE>
<P>If no callback function is specified then the grid will send a <CODE>GVN_GETDISPINFO</CODE> message to it's parent. A <CODE>GV_DISPINFO</CODE> structure part of this notification, and looks like:</P><PRE><span class='cpp-keyword'>typedef</span> <span class='cpp-keyword'>struct</span> tagGV_DISPINFO {
    NMHDR   hdr;
    GV_ITEM item;
} GV_DISPINFO;</PRE>
<P>Obviously it's nice to have a hint as to what sort of data the grid will be asking for in order to allow caching, so the grid sends out a <CODE>GVN_ODCACHEHINT</CODE> message before displaying a page of cells. A <CODE>GV_CACHEHINT</CODE> structure is sent as part of this message and looks like:</P><PRE><span class='cpp-keyword'>typedef</span> <span class='cpp-keyword'>struct</span> tagGV_CACHEHINT {
    NMHDR      hdr;
    CCellRange range;
} GV_CACHEHINT;</PRE>
<P>An example of handling these messages is as follows: </P><PRE><span class='cpp-comment'>// m_Grid is a member variable of a dialog class that is handling</span>
<span class='cpp-comment'>// this message</span>
BOOL CGridCtrlDemoDlg::OnNotify(WPARAM wParam, LPARAM lParam, 
                                LRESULT* pResult) 
{
    <span class='cpp-keyword'>if</span> (wParam == (WPARAM)m_Grid.GetDlgCtrlID())
    {
        *pResult = <span class='cpp-literal'>1</span>;
        GV_DISPINFO *pDispInfo = (GV_DISPINFO*)lParam;
        <span class='cpp-keyword'>if</span> (GVN_GETDISPINFO == pDispInfo-&gt;hdr.code)
        {
            <span class='cpp-comment'>//TRACE2("Getting Display info for cell %d,%d\n", </span>
                     pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
            pDispInfo-&gt;item.strText.Format(_T(<span class='cpp-string'>"Message %d,%d"</span>),
                     pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
            <span class='cpp-keyword'>return</span> TRUE;
        }
        <span class='cpp-keyword'>else</span> <span class='cpp-keyword'>if</span> (GVN_ODCACHEHINT == pDispInfo-&gt;hdr.code)
        {
            GV_CACHEHINT *pCacheHint = (GV_CACHEHINT*)pDispInfo;
            TRACE(_T(<span class='cpp-string'>"Cache hint received for cell range %d,%d - %d,%d\n"</span>),
                  pCacheHint-&gt;range.GetMinRow(), 
                  pCacheHint-&gt;range.GetMinCol(),
                  pCacheHint-&gt;range.GetMaxRow(), 
                  pCacheHint-&gt;range.GetMaxCol());
        }
    }
    
	<span class='cpp-keyword'>return</span> CDialog::OnNotify(wParam, lParam, pResult);
}</PRE>
<P>You can use <CODE>SetCallbackFunc</CODE> to set a callback function that the grid will call directly instead of sending a <CODE>GVN_GETDISPINFO</CODE> message. A <CODE>GVN_ODCACHEHINT</CODE> message will still be send if a callback is used. 
<P>The callback function should be of the form: </P><PRE>BOOL CALLBACK CallbackFunction(GV_DISPINFO * pDispInfo, LPARAM lParam);</PRE>
<P>For example: </P><PRE>BOOL CALLBACK CGridCtrlDemoDlg::GridCallback(GV_DISPINFO *pDispInfo, 
                                             LPARAM <span class='cpp-comment'>/*lParam*/</span>) 
{
    pDispInfo-&gt;item.strText.Format(_T(<span class='cpp-string'>"Callback %d,%d"</span>),
                          pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
    <span class='cpp-keyword'>return</span> TRUE;
}</PRE>
<P>When calling <CODE>SetCallbackFunc</CODE> you can specify an <CODE>LPARAM</CODE> value that will be passed to the callback function each time it is called. Note that the callback function must be a static or global function. 
<H2><A name=Appearance>General appearance and features</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetImageList(CImageList* pList)</CODE> </TD>
<TD class=smallText width="100%">Sets the current image list for the grid. The control only takes a copy of the pointer to the image list, not a copy of the list itself.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CImageList* GetImageList()</CODE> </TD>
<TD class=smallText width="100%">Gets the current image list for the grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetGridLines(<span class='cpp-keyword'>int</span> nWhichLines = GVL_BOTH)</CODE> </TD>
<TD class=smallText width="100%">Sets which (if any) gridlines are displayed. See <A href="#GVL_Values">here</A> for possible values.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetGridLines() </CODE></TD>
<TD class=smallText width="100%">Gets which (if any) gridlines are displayed. See <A href="#GVL_Values">here</A> for possible return values.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetEditable(BOOL bEditable = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets if the grid is editable.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsEditable()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not the grid is editable.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetListMode(BOOL bEnableListMode = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets the grid into (or out of) List mode. When the grid is in list mode, full row selection is enabled and clicking on the column header will sort the grid by rows.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetListMode()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not the grid is in list mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetSingleRowSelection(BOOL bSing = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets the grid into (or out of) Single row selection mode. This mode is only effective when in ListMode. When in this mode, only a single row at a time can be selected, so the grid behaves somewhat like a multicolumn listbox.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetSingleRowSelection()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not the grid is in single row selection mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetSingleColSelection(BOOL bSing = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets the grid into (or out of) Single column selection mode. When in this mode, only a single column at a time can be selected.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetSingleColSelection()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not the grid is in single column selection mode.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableSelection(BOOL bEnable = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not the grid cells can be selected.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsSelectable()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not grid cells are selectable.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetFixedRowSelection(BOOL bSelect)</CODE> </TD>
<TD class=smallText width="100%">Set whether or not clicking on a fixed row selects the cells next to it.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetFixedRowSelection()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not clicking on a fixed row selects the cells next to it.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetFixedColumnSelection(BOOL bSelect)</CODE> </TD>
<TD class=smallText width="100%">Set whether or not clicking on a fixed column selects the cells underneath.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetFixedColumnSelection()</CODE> </TD>
<TD class=smallText width="100%">Get whether or not clicking on a fixed column selects the cells underneath.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableDragAndDrop(BOOL bAllow = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether drag and drop is enabled.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetDragAndDrop()</CODE> </TD>
<TD class=smallText width="100%">Get whether drag and drop is allowed.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetRowResize(BOOL bResize = TRUE) </CODE></TD>
<TD class=smallText width="100%">Sets whether or not rows can be resized.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetRowResize()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not rows can be resized.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetColumnResize(BOOL bResize = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not columns can be resized.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetColumnResize()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not columns can be resized.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetHandleTabKey(BOOL bHandleTab = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not the TAB key is used to move the cell selection.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetHandleTabKey()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not the TAB key is used to move the cell selection.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetDoubleBuffering(BOOL bBuffer = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not double buffering is used when painting (avoids flicker).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetDoubleBuffering()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not double buffering is used when painting.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableTitleTips(BOOL bEnable = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not titletips are used.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetTitleTips()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not titletips are used.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetTrackFocusCell(BOOL bTrack)</CODE></TD>
<TD class=smallText width="100%">Sets whether or not the fixed cells on the same row/column as the current focus cell are highlighted with a sunken border</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetTrackFocusCell()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not the fixed cells on the same row/column as the current focus cell are highlighted with a sunken border</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetFrameFocusCell(BOOL bFrame)</CODE></TD>
<TD class=smallText width="100%">Sets whether or not the cell with the focus is highlighted with a framed border</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetFrameFocusCell()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not the focus cell is highlighted with a framed border</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetAutoSizeStyle(<span class='cpp-keyword'>int</span> nStyle = GVS_BOTH)</CODE></TD>
<TD class=smallText width="100%">Sets how the auto-sizing should be performed. GVS_BOTH = use fixed and non fixed cells; GVS_HEADER = use only the fixed cells; GVS_DATA = use only non-fixed cells. </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetAutoSizeStyle()</CODE></TD>
<TD class=smallText width="100%">Gets how the auto-sizing should be performed</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableHiddenColUnhide(BOOL bEnable = TRUE)</CODE></TD>
<TD class=smallText width="100%">Sets whether or not hidden (0-width) columns can be unhidden by the user resizing the column.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetHiddenColUnhide()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not hidden (0-width) columns can be unhidden by the user resizing the column.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableHiddenRowUnhide(BOOL bEnable = TRUE)</CODE></TD>
<TD class=smallText width="100%">Sets whether or not hidden (0-height) rows can be unhidden by the user resizing the row.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetHiddenRowUnhide()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not hidden (0-height) rows can be unhidden by the user resizing the row.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableColumnHide(BOOL bEnable = TRUE)</CODE></TD>
<TD class=smallText width="100%">Sets whether or columns can be contracted to 0 width via mouse.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetColumnHide()</CODE></TD>
<TD class=smallText width="100%">Gets whether or not columns can be contracted to 0 width via mouse.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableRowHide(BOOL bEnable = TRUE)</CODE></TD>
<TD class=smallText width="100%">Sets whether or not rows can be contracted to 0 height via mouse.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetRowHide()</CODE></TD>
<TD class=smallText width="100%">ets whether or not rows can be contracted to 0 height via mouse.</TD></TR></TBODY></TABLE>
<H2><A name=Colours>Colours</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetGridBkColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the background colour of the control (the area outside fixed and non-fixed cells).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetGridBkColor() </CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the control.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetGridLineColor(COLORREF clr)</CODE></TD>
<TD class=smallText width="100%">Sets the colour of the gridlines.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetGridLineColor() </CODE></TD>
<TD class=smallText width="100%">Gets the colour of the grid lines.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetTitleTipBackClr() </CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the titletips.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetTitleTipBackClr(COLORREF clr = CLR_DEFAULT)</CODE></TD>
<TD class=smallText width="100%">Sets the background colour of the titletips.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetTitleTipTextClr() </CODE></TD>
<TD class=smallText width="100%">Gets the text colour of the titletips.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetTitleTipTextClr(COLORREF clr = CLR_DEFAULT)</CODE></TD>
<TD class=smallText width="100%">Sets the text colour of the titletips.</TD></TR></TBODY></TABLE>
<P><B>The following functions are no longer supported.</B> You should use <CODE>GetDefaultCell</CODE> to get the default cell implementation for the cell type you are intererested in, then set that cell's properties directly. If a given cell has default values set, then it will use the values in the default cell implementation that matches that cell type.</P>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetTextColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the colour of the text in non-fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetTextColor()</CODE> </TD>
<TD class=smallText width="100%">Gets the colour of the text in non-fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetTextBkColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the background colour of the non-fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetTextBkColor() </CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the non-fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetFixedTextColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the colour of the text in fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetFixedTextColor()</CODE> </TD>
<TD class=smallText width="100%">Gets the colour of the text in fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetFixedBkColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the background colour of the fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetFixedBkColor() </CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the fixed cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetBkColor(COLORREF clr)</CODE> </TD>
<TD class=smallText width="100%">Sets the background colour of the control (the area outside fixed and non-fixed cells).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetBkColor() </CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the control.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetGridColor(COLORREF clr)</CODE></TD>
<TD class=smallText width="100%">Sets the colour of the gridlines.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetGridColor() </CODE></TD>
<TD class=smallText width="100%">Gets the colour of the grid lines.</TD></TR></TBODY></TABLE>
<P>See also the <A href="#CellColours">Individual Cell colour functions</A> that allow an individual cell's colours to be changes seperate to the rest of the grid. 
<H2><A name=CellInfo>General cell information</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE>CGridCellBase* GetDefaultCell(BOOL bFixedRow,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BOOL bFixedCol) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Gets a pointer to the default cell implementation for the desired cell type. <I>bFixedRow</I> and <I>bFixedCol</I> specify whether the cell is fixed (in row, column or both) or unfixed. Use this to set default properties for the grid. Actual cells in the grid have their values set as default values when they are first created. They will use <CODE>GetDefaultCell</CODE> to query the grids default cell properties and use these values for drawing themselves.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CGridCellBase* GetCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Gets the actual cell for the given row/column (or NULL on failure)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetCellType(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRuntimeClass* pRuntimeClass);</CODE></TD>
<TD class=smallText width="100%">Sets the cell class type.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetDefaultCellType(CRuntimeClass* pRuntimeClass);</CODE></TD>
<TD class=smallText width="100%">Sets the default cell class type for new cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetModified(BOOL bModified = TRUE,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> nRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nCol = -<span class='cpp-literal'>1</span>)</CODE> </TD>
<TD class=smallText width="100%">Sets the modified flag for a cell. If no row or columns is specified, then change affects the entire grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetModified(<span class='cpp-keyword'>int</span> nRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nCol = -<span class='cpp-literal'>1</span>)</CODE> </TD>
<TD class=smallText width="100%">Sets the modified flag for a cell, or if no cell, it returns the status for the entire grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsCellFixed(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the cell is a fixed cell.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsItemEditing(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the cell is currently being edited.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItem(<span class='cpp-keyword'>const</span> GV_ITEM* pItem)</CODE></TD>
<TD class=smallText width="100%">Sets the contents of a cell with the values from the <A href="#GV_ITEM">GV_ITEM</A> structure. Note that the value of the mask field will determine which values are actually changed (cf. CListCtrl::SetItem).</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetItem(GV_ITEM* pItem)</CODE></TD>
<TD class=smallText width="100%">Fills the <A href="#GV_ITEM">GV_ITEM</A> structure with values from the specified cell. Note that the value of the mask field will determine which values are actually retrieved (cf. CListCtrl::GetItem). </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemText(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, LPCTSTR str)</CODE></TD>
<TD class=smallText width="100%">Sets the text for the given cell. Returns TRUE on success</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> CString GetItemText(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Gets the text for the given cell. This function is virtual in order to aid extensibility. No more messing around with LVN_GETDISPINFO messages or string pooling!</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemData(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPARAM lParam)</CODE> </TD>
<TD class=smallText width="100%">Sets the lParam (user-defined data) field for the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>LPARAM GetItemData(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the lParam (user-defined data) field for the given cell. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemImage(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> iImage)</CODE> </TD>
<TD class=smallText width="100%">Sets the image index for the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetItemImage(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the image index for the given cell.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemState(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT state)</CODE> </TD>
<TD class=smallText width="100%">Sets the state of the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>UINT GetItemState(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the state of the given cell. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemFormat(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT nFormat)</CODE> </TD>
<TD class=smallText width="100%">Sets the format of the given cell. Returns TRUE on success. Default implementation of cell drawing uses CDC::DrawText, so any of the DT_* formats are available. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>UINT GetItemFormat(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the format of the given cell (default returns a CDC::DrawText DT_* format). See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetSelectedCount()</CODE> </TD>
<TD class=smallText width="100%">Gets the number of selected cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CCellID GetFocusCell()</CODE></TD>
<TD class=smallText width="100%">Gets the cell with the focus. See also <A href="#CCellID">CCellID</A><A>.</A></TD></TR>
<TR>
<TD noWrap><CODE>CCellID SetFocusCell(CCellID cell);<BR>CCellID SetFocusCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol);</CODE> </TD>
<TD class=smallText width="100%">Sets the cell with the focus</TD></TR><A name=CellColours></A>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemBkColour(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; COLORREF cr = CLR_DEFAULT)</CODE></TD>
<TD class=smallText width="100%">Sets the background colour of the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetItemBkColour(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Gets the background colour of the given cell. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemFgColour(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; COLORREF cr = CLR_DEFAULT)</CODE></TD>
<TD class=smallText width="100%">Sets the foreground colour of the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>COLORREF GetItemFgColour(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Gets the foreground colour of the given cell. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL SetItemFont(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LOGFONT* lf)</CODE></TD>
<TD class=smallText width="100%">Sets the font of the given cell. Returns TRUE on success. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR>
<TD noWrap><CODE>LOGFONT* GetItemFont(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol) <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Gets the font of the given cell. See also <A href="#GV_ITEM">GV_ITEM</A>.</TD></TR>
<TR>
<TD noWrap><CODE>BOOL IsItemEditing(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE></TD>
<TD class=smallText width="100%">Returns TRUE if the cell is currently being edited.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnsureVisible(CCellID &amp;cell)</CODE></TD>
<TD class=smallText width="100%">Ensures that the specified cell is visible.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsCellVisible(CCellID &amp;cell) <span class='cpp-keyword'>const</span><BR>BOOL IsCellVisible(CCellID cell) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Returns TRUE if the cell is visible.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsCellEditable(CCellID &amp;cell) <span class='cpp-keyword'>const</span><BR>BOOL IsCellEditable(CCellID cell) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Returns TRUE if the cell is editable.</TD></TR>
<TR>
<TD noWrap><CODE>BOOL IsCellSelected(CCellID &amp;cell) <span class='cpp-keyword'>const</span><BR>BOOL IsCellSelected(CCellID cell) <span class='cpp-keyword'>const</span></CODE></TD>
<TD class=smallText width="100%">Returns TRUE if the cell is selected</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnsureVisible(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE></TD>
<TD class=smallText width="100%">Ensures that the specified cell is visible.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsCellFixed(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the given cell is a fixed cell</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetDefCellHeight() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the default cell height (for new cells)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetDefCellHeight(<span class='cpp-keyword'>int</span> nHeight)</CODE> </TD>
<TD class=smallText width="100%">Sets the default cell height (for new cells). This will be overridden if <CODE>SetFont</CODE> is called</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetDefCellWidth() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the default cell width (for new cells)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetDefCellWidth(<span class='cpp-keyword'>int</span> nWidth)</CODE> </TD>
<TD class=smallText width="100%">Sets the default cell width (for new cells). This will be overridden if <CODE>SetFont</CODE> is called</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> GetDefCellWidth() <span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Returns the default cell internal margin</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetDefCellMargin(<span class='cpp-keyword'>int</span> nMargin)</CODE> </TD>
<TD class=smallText width="100%">Sets the default cell internal margin.</TD></TR></TBODY></TABLE>
<H2><A name=Operations>Operations</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> InsertColumn(LPCTSTR strHeading, &nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT nFormat, <span class='cpp-keyword'>int</span> nColumn = -<span class='cpp-literal'>1</span>)</CODE></TD>
<TD class=smallText width="100%">Inserts a column at the position given by nCol, or at the end of all columns if nCol is &lt; 0. <B>strHeading</B> is the column heading and <B>nFormat</B> the format. Returns the position of the inserted column.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>int</span> InsertRow(LPCTSTR strHeading,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> nRow = -<span class='cpp-literal'>1</span>)</CODE> </TD>
<TD class=smallText width="100%">Inserts a row at the position given by nRow, or at the end of all rows if nRow is &lt; 0. <B>strHeading</B> is the row heading. The format of each cell in the row will be that of the cell in the first row of the same column. Returns the position of the inserted row.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL DeleteColumn(<span class='cpp-keyword'>int</span> nColumn)</CODE> </TD>
<TD class=smallText width="100%">Deletes column "nColumn", return TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL DeleteRow(<span class='cpp-keyword'>int</span> nRow)</CODE> </TD>
<TD class=smallText width="100%">Deletes row "nRow", return TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL DeleteAllItems()</CODE> </TD>
<TD class=smallText width="100%">Deletes all rows and contents in the grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL DeleteNonFixedRows()</CODE> </TD>
<TD class=smallText width="100%">Deletes all non-fixed rows in the grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL AutoSizeRow(<span class='cpp-keyword'>int</span> nRow, BOOL bResetScroll=TRUE)</CODE> </TD>
<TD class=smallText width="100%">Auto sizes the row to the size of the largest item. If <I>bResetScroll</I> is TRUE then the scroll bars will be reset.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL AutoSizeColumn(<span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT nAutoSizeStyle = GVS_DEFAULT,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BOOL bResetScroll = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Auto sizes the column to the size of the largest item. <I>nAutoSizeStyle</I> sets the way the autosize will occur (see <A href="#AutosizeOption">AutoSizing options</A>). If <I>bResetScroll</I> is TRUE then the scroll bars will be reset.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> AutoSizeRows()</CODE> </TD>
<TD class=smallText width="100%">Auto sizes all rows.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> AutoSizeColumns(UINT nAutoSizeStyle=GVS_DEFAULT)</CODE> </TD>
<TD class=smallText width="100%">Auto sizes all columns. <I>nAutoSizeStyle</I> sets the way the autosize will occur. (see <A href="#AutosizeOption">AutoSizing options</A>) </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> AutoSize(UINT nAutoSizeStyle = GVS_DEFAULT)</CODE> </TD>
<TD class=smallText width="100%">Auto sizes all rows and columns. <I>nAutoSizeStyle</I> sets the way the autosize will occur. (see <A href="#AutosizeOption">AutoSizing options</A>)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> ExpandColumnsToFit(BOOL bExpandFixed=TRUE)</CODE> </TD>
<TD class=smallText width="100%">Expands the column widths to fit the grid area. If <I>bExpandFixed</I> is TRUE then fixed columns will be modified, otherwise they will not be affected.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> ExpandLastColumn()</CODE> </TD>
<TD class=smallText width="100%">Expands the last column width to fill any remaining grid area.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> ExpandRowsToFit(BOOL bExpandFixed=TRUE)</CODE> </TD>
<TD class=smallText width="100%">Expands the row heights to fit the grid area. If <I>bExpandFixed</I> is TRUE then fixed rows will be modified, otherwise they will not be affected.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> ExpandToFit(BOOL bExpandFixed = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Expands the rows and columns to fit the grid area. If <I>bExpandFixed</I> is TRUE then fixed cells will be modified, otherwise they will not be affected.&lt;</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CSize GetTextExtent(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, LPCTSTR str)</CODE> </TD>
<TD class=smallText width="100%">Gets the size of the text pointed to by str for the given cell </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CSize GetCellTextExtent(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Gets the size of the text of the given cell </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetRedraw(BOOL bAllowDraw, &nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BOOL bResetScrollBars = FALSE)</CODE> </TD>
<TD class=smallText width="100%">Stops/starts redraws on things like changing the number of rows and columns and autosizing, but not for user-intervention such as resizes.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL RedrawCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDC* pDC = NULL)</CODE> </TD>
<TD class=smallText width="100%">Redraws the given cell. Drawing will be via the pDC if one is supplied.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL RedrawCell(<span class='cpp-keyword'>const</span> CCellID&amp; cell,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDC* pDC = NULL)</CODE> </TD>
<TD class=smallText width="100%">Redraws the given cell. Drawing will be via the pDC if one is supplied.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL RedrawRow(<span class='cpp-keyword'>int</span> row)</CODE> </TD>
<TD class=smallText width="100%">Redraws the given row.</TD></TR>
<TR>
<TD noWrap><CODE>BOOL RedrawColumn(<span class='cpp-keyword'>int</span> col)</CODE> </TD>
<TD class=smallText width="100%">Redraws the given column</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL Refresh()</CODE> </TD>
<TD class=smallText width="100%">Redraws the entire grid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CCellRange GetCellRange()</CODE> </TD>
<TD class=smallText width="100%">Gets the range of cells for the entire grid. See also <A href="#CCellRange">CCellRange</A><A>.</A></TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetSelectedRange(<span class='cpp-keyword'>const</span> CCellRange&amp; Range,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; BOOL bForceRepaint = FALSE);</CODE> </TD>
<TD class=smallText width="100%">Sets the range of selected cells. See also <A href="#CCellRange">CCellRange</A><A>.</A></TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetSelectedRange(<span class='cpp-keyword'>int</span> nMinRow, <span class='cpp-keyword'>int</span> nMinCol,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span class='cpp-keyword'>int</span> nMaxRow, <span class='cpp-keyword'>int</span> nMaxCol,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; BOOL bForceRepaint = FALSE);</CODE> </TD>
<TD class=smallText width="100%">Sets the range of selected cells.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsValid(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the given row and column is valid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsValid(<span class='cpp-keyword'>const</span> CCellID&amp; cell)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the given cell is valid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL IsValid(<span class='cpp-keyword'>const</span> CCellRange&amp; range)</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if the given cell range is valid.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>CCellID GetNextItem(CCellID&amp; cell, <span class='cpp-keyword'>int</span> nFlags)<BR>&nbsp;<span class='cpp-keyword'>const</span></CODE> </TD>
<TD class=smallText width="100%">Searches for a cell that has the specified properties and that bears the specified relationship to a given item. (See also CListCtrl::GetNextItem and <A href="#CellSearch">Cell Searching options</A>)</TD></TR></TBODY></TABLE>
<H2><A name=Sorting>Sorting</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap width="50%"><CODE><span class='cpp-keyword'>void</span> SetHeaderSort(BOOL bSortOnClick = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Sets whether or not rows are sorted on column header clicks in ListMode.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>BOOL GetHeaderSort()</CODE> </TD>
<TD class=smallText width="100%">Gets whether or not rows are sorted on column header clicks in ListMode.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>SetSortColumn(<span class='cpp-keyword'>int</span> nCol</CODE></TD>
<TD class=smallText width="100%">Sets the index of the currently sorted column.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE><span class='cpp-keyword'>int</span> GetSortColumn()</CODE></TD>
<TD class=smallText width="100%">Gets the index of the currently sorted column.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE><span class='cpp-keyword'>void</span> SetSortAscending(BOOL bAscending)</CODE></TD>
<TD class=smallText width="100%">Sets whether the current sort column is sorted ascending.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>BOOL GetSortAscending()</CODE></TD>
<TD class=smallText width="100%">Gets whether the current sort column is sorted ascending.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>BOOL SortTextItems(<span class='cpp-keyword'>int</span> nCol, BOOL bAscending,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPARAM data = <span class='cpp-literal'>0</span>)</CODE> </TD>
<TD class=smallText width="100%">Sorts the grid on the given column based on cell text. Returns TRUE on success.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>BOOL SortItems(<span class='cpp-keyword'>int</span> nCol, BOOL bAscending,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LPARAM data = <span class='cpp-literal'>0</span>)</CODE> </TD>
<TD class=smallText width="100%">Sorts the grid on the given column based using the current comparison function. If no function has been specified then the rows are sorted by text. Returns TRUE on success. <BR>See also SetCompareFunction()</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE><span class='cpp-keyword'>void</span> SetCompareFunction(PFNLVCOMPARE pfnCompare)</CODE> </TD>
<TD class=smallText width="100%">Sets the callback function that will be used to sort the grid rows. See below for more details.</TD></TR>
<TR vAlign=top>
<TD noWrap width="50%"><CODE>BOOL SortItems(PFNLVCOMPARE pfnCompare, <span class='cpp-keyword'>int</span> nCol,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BOOL bAscending, LPARAM data = <span class='cpp-literal'>0</span>)</CODE> </TD>
<TD class=smallText width="100%">Sorts the grid on the given column using the supplied compare function pfnCompare. See CListCtrl::SortItems for information in the form of this function. Returns TRUE on success.</TD></TR></TBODY></TABLE>
<P>Sorting is achieved by calling one of the variants of <CODE>SortItems</CODE>, <CODE>SortTextItems</CODE>, or by the user clicking on a column header when in list mode.&nbsp; 
<P><B>Note:</B> Sorting will not work in virtual mode. This is because in virtual mode the grid does not store information about the cells in the grid, hence is unable to store any kind of sort order for the cells. 
<P>The simplest way to handle sorting is to set the function that will be used in cell comparisons (by calling <CODE>SetCompareFunction</CODE>) and then calling <CODE>SortItems(<span class='cpp-keyword'>int</span> nCol, BOOL bAscending, LPARAM data = <span class='cpp-literal'>0</span>)</CODE>. <I>nCol</I> is the column to sort, <EM>bAscending</EM> sets whether the sort is in ascending or descending order, and <I>data</I> is application specific data that will be passed to the comparison function. 
<P>The comparison function must be a global or static function with the form </P><PRE><span class='cpp-keyword'>int</span> CALLBACK pfnCellCompare(LPARAM lParam1, LPARAM lParam2, LPARAM lParamSort)</PRE>
<P><I>lParam1</I> and <I>lParam2</I> will be <CODE>CGridCellBase</CODE> pointers, and <I>lParamSort</I> will be the application specific data you pass into the <CODE>SortItems</CODE> function as the <I>data</I> parameter. The function must return -1 if the first cell contains a value less than the second cell; 0 if they are equal, otherwise 1. 
<P>An example of a sort comparison function is as follows: </P><PRE><span class='cpp-keyword'>int</span> CALLBACK MyClass::pfnCellNumericCompare(LPARAM lParam1,
                                            LPARAM lParam2, 
                                            LPARAM lParamSort)
{
	CGridCellBase* pCell1 = (CGridCellBase*) lParam1;
	CGridCellBase* pCell2 = (CGridCellBase*) lParam2;
	<span class='cpp-keyword'>if</span> (!pCell1 || !pCell2) <span class='cpp-keyword'>return</span> <span class='cpp-literal'>0</span>;

	<span class='cpp-keyword'>int</span> nValue1 = _ttol(pCell1-&gt;GetText());
	<span class='cpp-keyword'>int</span> nValue2 = _ttol(pCell2-&gt;GetText());

	<span class='cpp-keyword'>if</span> (nValue1 &lt; nValue2)
		<span class='cpp-keyword'>return</span> -<span class='cpp-literal'>1</span>;
	<span class='cpp-keyword'>else</span> <span class='cpp-keyword'>if</span> (nValue1 == nValue2)
		<span class='cpp-keyword'>return</span> <span class='cpp-literal'>0</span>;
	<span class='cpp-keyword'>else</span>
		<span class='cpp-keyword'>return</span> <span class='cpp-literal'>1</span>;
}</PRE>
<P>Two functions have been provided for your convenience: </P><PRE><span class='cpp-keyword'>int</span> CALLBACK CGridCtrl::pfnCellTextCompare(LPARAM lParam1, 
                                           LPARAM lParam2, 
                                           LPARAM lParamSort)
<span class='cpp-keyword'>int</span> CALLBACK CGridCtrl::pfnCellNumericCompare(LPARAM lParam1, 
                                              LPARAM lParam2, 
                                              LPARAM lParamSort)</PRE>
<P>These sort by Text value and by numeric value (using <CODE>itoa</CODE> respectively. To set the comparison function for the grid simply call: </P><PRE>m_Grid.SetCompareFunction(CGridCtrl::pfnCellNumericCompare);</PRE>
<P>If the comparison function is set as NULL, <CODE>CGridCtrl::pfnCellTextCompare</CODE> will be used by default. 
<H2><A name=Printing>Printing</A></H2>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> EnableWysiwygPrinting(BOOL bEnable = TRUE)</CODE> </TD>
<TD class=smallText width="100%">Set WYSIWYG Printing </TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetWysiwygPrinting()</CODE> </TD>
<TD class=smallText width="100%">Returns TRUE if WYSIWYG Printing is set</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> Print()</CODE> </TD>
<TD class=smallText width="100%">Prints the grid control on the user selected device. (Useful where the control is used in a dialog)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnBeginPrinting(CDC *pDC,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPrintInfo *pInfo)</CODE> </TD>
<TD class=smallText width="100%">Used in a Doc/View environment. Call in your CView dervied class' OnBeginPrinting.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnPrint(CDC *pDC, CPrintInfo *pInfo)</CODE> </TD>
<TD class=smallText width="100%">Used in a Doc/View environment. Call in your CView dervied class' OnPrint.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEndPrinting(CDC *pDC,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPrintInfo *pInfo)</CODE> </TD>
<TD class=smallText width="100%">Used in a Doc/View environment. Call in your CView dervied class' OnEndPrinting.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetShadedPrintOut(BOOL bEnable = TRUE)</CODE> </TD>
<TD class=smallText width="100%">If TRUE, colored cells will print as-is. If FALSE, all text prints as black on white.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE>BOOL GetShadedPrintOut()</CODE> </TD>
<TD class=smallText width="100%">Get's whether or not cells are printed shaded or as-is.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> SetPrintMarginInfo(<span class='cpp-keyword'>int</span> nHeaderHeight,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> nFooterHeight, <span class='cpp-keyword'>int</span> nLeftMargin,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> nRightMargin, <span class='cpp-keyword'>int</span> nTopMargin,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> nBottomMargin, <span class='cpp-keyword'>int</span> nGap)</CODE></TD>
<TD class=smallText width="100%">Set printing margin info.</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>void</span> GetPrintMarginInfo(<span class='cpp-keyword'>int</span> &amp;nHeaderHeight,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> &amp;nFooterHeight, <span class='cpp-keyword'>int</span> &amp;nLeftMargin,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> &amp;nRightMargin, <span class='cpp-keyword'>int</span> &amp;nTopMargin,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='cpp-keyword'>int</span> &amp;nBottomMargin, <span class='cpp-keyword'>int</span> &amp;nGap)</CODE> </TD>
<TD class=smallText width="100%">Get printing margin info.</TD></TR></TBODY></TABLE>
<H2><A name=Structures>Structures, defines and Messages</A></H2>
<H3>The CGridCellBase class</H3>
<P>This class is the base class for all grid cell classes, and holds the information for each cell. The class also defines a number of methods that are called by the grid itself, such as drawing and printing. Almost all methods and functions are virtual and this class is not designed to be used directly - rather it should be derived from. The default class <CODE>CGridCell</CODE> is derived from <CODE>CGridCellBase</CODE> and is used by the Grid control as the default cell class.</P>
<H4>Attributes</H4><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetText(LPCTSTR szText);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetImage(<span class='cpp-keyword'>int</span> nImage);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetData(LPARAM lParam);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetState(DWORD nState);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetFormat(DWORD nFormat);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetTextClr(COLORREF clr);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetBackClr(COLORREF clr);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetFont(<span class='cpp-keyword'>const</span> LOGFONT* plf);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetGrid(CGridCtrl* pGrid);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetCoords(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nColumn);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> SetMargin(UINT nMargin);

<span class='cpp-keyword'>virtual</span> LPCTSTR  GetText() <span class='cpp-keyword'>const</span>         <span class='cpp-comment'>// returns the text in the cell</span>
<span class='cpp-keyword'>virtual</span> LPCTSTR  GetTipText() <span class='cpp-keyword'>const</span>      <span class='cpp-comment'>// return alternate tooltip text </span>
                                         <span class='cpp-comment'>// if you wish </span>
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>int</span>      GetImage() <span class='cpp-keyword'>const</span>        <span class='cpp-comment'>// returns image index for cell</span>
<span class='cpp-keyword'>virtual</span> LPARAM   GetData() <span class='cpp-keyword'>const</span>         <span class='cpp-comment'>// returns data associated with cell</span>
<span class='cpp-keyword'>virtual</span> DWORD    GetState() <span class='cpp-keyword'>const</span>        <span class='cpp-comment'>// returns cell state</span>
<span class='cpp-keyword'>virtual</span> DWORD    GetFormat() <span class='cpp-keyword'>const</span>       <span class='cpp-comment'>// returns cell format</span>
<span class='cpp-keyword'>virtual</span> COLORREF GetTextClr() <span class='cpp-keyword'>const</span>      <span class='cpp-comment'>// returns cell text color</span>
<span class='cpp-keyword'>virtual</span> COLORREF GetBackClr() <span class='cpp-keyword'>const</span>      <span class='cpp-comment'>// returns cell background color</span>
<span class='cpp-keyword'>virtual</span> LOGFONT* GetFont() <span class='cpp-keyword'>const</span>         <span class='cpp-comment'>// returns cell font as a LOGFONT</span>
<span class='cpp-keyword'>virtual</span> CFont*   GetFontObject() <span class='cpp-keyword'>const</span>   <span class='cpp-comment'>// returns a CFont object with the </span>
                                         <span class='cpp-comment'>// cell's font</span>
<span class='cpp-keyword'>virtual</span> UINT     GetMargin() <span class='cpp-keyword'>const</span>       <span class='cpp-comment'>// returns internal margin for cell</span>
<span class='cpp-keyword'>virtual</span> CGridCtrl* GetGrid() <span class='cpp-keyword'>const</span>       <span class='cpp-comment'>// returns grid that cell is associated </span>
                                         <span class='cpp-comment'>// with</span>
<span class='cpp-keyword'>virtual</span> CWnd*    GetEditWnd() <span class='cpp-keyword'>const</span>      <span class='cpp-comment'>// returns editing window for cell, </span>
                                         <span class='cpp-comment'>// or NULL</span>
    
<span class='cpp-keyword'>virtual</span> BOOL IsEditing() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsFocused()  <span class='cpp-keyword'>const</span> 
<span class='cpp-keyword'>virtual</span> BOOL IsFixed()    <span class='cpp-keyword'>const</span> 
<span class='cpp-keyword'>virtual</span> BOOL IsFixedCol() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsFixedRow() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsSelected() <span class='cpp-keyword'>const</span> 
<span class='cpp-keyword'>virtual</span> BOOL IsReadOnly() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsModified() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsDropHighlighted() <span class='cpp-keyword'>const</span>
<span class='cpp-keyword'>virtual</span> BOOL IsDefaultFont() <span class='cpp-keyword'>const</span>       <span class='cpp-comment'>// TRUE if cell is using default</span>
                                         <span class='cpp-comment'>// font in grid</span>

<span class='cpp-keyword'>virtual</span> CGridCellBase* GetDefaultCell() <span class='cpp-keyword'>const</span>;
</PRE>
<H4>Operators</H4><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> <span class='cpp-keyword'>operator</span>=(CGridCellBase&amp; cell);</PRE>
<H4>Operations</H4><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> Reset();

<span class='cpp-keyword'>virtual</span> BOOL Draw(CDC* pDC, <span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, CRect rect, 
                  BOOL bEraseBkgnd = TRUE);
<span class='cpp-keyword'>virtual</span> BOOL GetTextRect( LPRECT pRect)     - dimensions of text 
                                              within cell
<span class='cpp-keyword'>virtual</span> BOOL GetTipTextRect( LPRECT pRect)  - boundary <span class='cpp-keyword'>for</span> tooltips
<span class='cpp-keyword'>virtual</span> CSize GetTextExtent(LPCTSTR str)    - size of text
<span class='cpp-keyword'>virtual</span> CSize GetCellExtent(CDC* pDC)       - size of cell

<span class='cpp-comment'>// start and stop cell editing</span>
<span class='cpp-keyword'>virtual</span> BOOL Edit(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, CRect rect, 
                  CPoint point, UINT nID, UINT nChar) 
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> EndEdit()

<span class='cpp-comment'>// Validates the results of an edit. If "str" is not a valid </span>
<span class='cpp-comment'>// value for the</span>
<span class='cpp-comment'>// cell then  return FALSE to have the edit rejected</span>
<span class='cpp-keyword'>virtual</span> BOOL ValidateEdit(LPCTSTR str);

<span class='cpp-keyword'>virtual</span> BOOL PrintCell(CDC* pDC, <span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, CRect rect);

<span class='cpp-comment'>// This can ONLY be called by CGridCellBase derived classes, and </span>
<span class='cpp-comment'>// not CGridCellBase itself.</span>
LRESULT SendMessageToParent(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, <span class='cpp-keyword'>int</span> nMessage);
</PRE>
<H4>Overridables</H4><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEndEdit();
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnMouseEnter();
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnMouseOver();
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnMouseLeave();
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnClick( CPoint PointCellRelative);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnClickDown( CPoint PointCellRelative);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnRClick( CPoint PointCellRelative);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnDblClick( CPoint PointCellRelative);
<span class='cpp-keyword'>virtual</span> BOOL OnSetCursor();
</PRE>
<P>This makes customising cells extremely simple. To install a new type of derived class for your grid cells, you can either override <CODE>CGridCtrl::CreateCell</CODE> and create your derived <CODE>CGridCellBase</CODE> cells, or you can use <CODE>CGridCtrl::SetCellType</CODE> and <CODE>CGridCtrl::SetDeafaultCellType</CODE> to automate this. 
<P>Simply create a new cell class derived from <CODE>CGridCellBase</CODE> or <CODE>CGridCell</CODE> (eg. <CODE>CMyGridCell</CODE>), and then replace the cells in the grid by calling </P><PRE>MyGrid.SetCellType(row, column, RUNTIME_CLASS(CMyGridCell));</PRE>
<P>The cell at (row,column) will now be of type <CODE>CMyGridCell</CODE>. 
<H3><A name=CCellID>The CGridCell class</A><A></H3>
<P>This class is derived from <CODE>CGridCellBase</CODE> and provides a default implementation for use with <CODE>CGridCtrl</CODE>. 
<H3></A><A name=CCellID>The CCellID class</A><A></H3>This is a handy helper class used to reference individual cells. All members are public. This class is adapted from Joe Willcoxsons original implementation. <PRE><span class='cpp-keyword'>class</span> CCellID
{    
<span class='cpp-keyword'>public</span>:
    <span class='cpp-keyword'>int</span> row, col; <span class='cpp-comment'>// The zero based row and column of the cell.</span>

    CCellID(<span class='cpp-keyword'>int</span> nRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nCol = -<span class='cpp-literal'>1</span>)

    <span class='cpp-keyword'>int</span> IsValid();
    <span class='cpp-keyword'>int</span> <span class='cpp-keyword'>operator</span>==(<span class='cpp-keyword'>const</span> CCellID&amp; rhs);
    <span class='cpp-keyword'>int</span> <span class='cpp-keyword'>operator</span>!=(<span class='cpp-keyword'>const</span> CCellID&amp; rhs);
}
</PRE>
<H3><A name=CCellRange>The CCellRange class</A></H3>
<P>This is a handy helper class used to reference cell ranges. This class is adapted from Joe Willcoxsons original implementation. </P><PRE><span class='cpp-keyword'>class</span> CCellRange
{ 
<span class='cpp-keyword'>public</span>:
    CCellRange(<span class='cpp-keyword'>int</span> nMinRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nMinCol = -<span class='cpp-literal'>1</span>, 
               <span class='cpp-keyword'>int</span> nMaxRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nMaxCol = -<span class='cpp-literal'>1</span>);
    <span class='cpp-keyword'>void</span> Set(<span class='cpp-keyword'>int</span> nMinRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nMinCol = -<span class='cpp-literal'>1</span>, 
             <span class='cpp-keyword'>int</span> nMaxRow = -<span class='cpp-literal'>1</span>, <span class='cpp-keyword'>int</span> nMaxCol = -<span class='cpp-literal'>1</span>);
    
    <span class='cpp-keyword'>int</span>  IsValid() <span class='cpp-keyword'>const</span>;
    <span class='cpp-keyword'>int</span>  InRange(<span class='cpp-keyword'>int</span> row, <span class='cpp-keyword'>int</span> col) <span class='cpp-keyword'>const</span>;       <span class='cpp-comment'>// Is the row/col in the range?</span>
    <span class='cpp-keyword'>int</span>  InRange(<span class='cpp-keyword'>const</span> CCellID&amp; cellID) <span class='cpp-keyword'>const</span>;  <span class='cpp-comment'>// is the cell in the range?</span>
    
    CCellID  GetTopLeft() <span class='cpp-keyword'>const</span>;                <span class='cpp-comment'>// Get topleft cell in range</span>
    CCellRange Intersect(<span class='cpp-keyword'>const</span> CCellRange&amp; rhs) <span class='cpp-keyword'>const</span>;&nbsp;
                                                <span class='cpp-comment'>// Returns the intersection of</span>
                                                <span class='cpp-comment'>// two cell ranges</span>

    <span class='cpp-keyword'>int</span> GetMinRow() <span class='cpp-keyword'>const</span>;                      <span class='cpp-comment'>// Self explanatory</span>
    <span class='cpp-keyword'>void</span> SetMinRow(<span class='cpp-keyword'>int</span> minRow);
    <span class='cpp-keyword'>int</span> GetMinCol() <span class='cpp-keyword'>const</span>;
    <span class='cpp-keyword'>void</span> SetMinCol(<span class='cpp-keyword'>int</span> minCol);
    <span class='cpp-keyword'>int</span> GetMaxRow() <span class='cpp-keyword'>const</span>;
    <span class='cpp-keyword'>void</span> SetMaxRow(<span class='cpp-keyword'>int</span> maxRow);
    <span class='cpp-keyword'>int</span> GetMaxCol() <span class='cpp-keyword'>const</span>;
    <span class='cpp-keyword'>void</span> SetMaxCol(<span class='cpp-keyword'>int</span> maxCol);

    <span class='cpp-keyword'>int</span> GetRowSpan() <span class='cpp-keyword'>const</span>;                    <span class='cpp-comment'>// Number of rows spanned</span>
    <span class='cpp-keyword'>int</span> GetColSpan() <span class='cpp-keyword'>const</span>;                    <span class='cpp-comment'>// Number of columns spanned</span>
    
    <span class='cpp-keyword'>void</span> <span class='cpp-keyword'>operator</span>=(<span class='cpp-keyword'>const</span> CCellRange&amp; rhs);
    <span class='cpp-keyword'>int</span>  <span class='cpp-keyword'>operator</span>==(<span class='cpp-keyword'>const</span> CCellRange&amp; rhs);
    <span class='cpp-keyword'>int</span>  <span class='cpp-keyword'>operator</span>!=(<span class='cpp-keyword'>const</span> CCellRange&amp; rhs);
}
</PRE>
<P><A name=GV_ITEM>The GV_ITEM structure</A><A>. This structure is used for Get/SetItem calls. </P><PRE><span class='cpp-keyword'>typedef</span> <span class='cpp-keyword'>struct</span> _GV_ITEM {
        <span class='cpp-keyword'>int</span>      row,col;   <span class='cpp-comment'>// Row and Column of item</span>
        UINT     mask;      <span class='cpp-comment'>// Mask for use in getting/setting cell data</span>
        UINT     state;     <span class='cpp-comment'>// cell state (focus/hilighted etc)</span>
        UINT     nFormat;   <span class='cpp-comment'>// Format of cell. Default imaplentation </span>
                            <span class='cpp-comment'>// used CDC::DrawText formats</span>
        CString  szText;    <span class='cpp-comment'>// Text in cell</span>
        <span class='cpp-keyword'>int</span>      iImage;    <span class='cpp-comment'>// index of the list view items icon</span>
        COLORREF crBkClr;   <span class='cpp-comment'>// Background colour (or CLR_DEFAULT)</span>
        COLORREF crFgClr;   <span class='cpp-comment'>// Forground colour (or CLR_DEFAULT)</span>
        LPARAM   lParam;    <span class='cpp-comment'>// 32-bit value to associate with item</span>
        LOGFONT  lfFont;    <span class='cpp-comment'>// cell font</span>
} GV_ITEM;</PRE></A><A name=GVL_Values>Grid line or scroll bar selection</A> <PRE>GVL_NONE      <span class='cpp-comment'>// No grid lines</span>
GVL_HORZ      <span class='cpp-comment'>// Horizontal lines only</span>
GVL_VERT      <span class='cpp-comment'>// Vertical lines only</span>
GVL_BOTH      <span class='cpp-comment'>// Both vertical and horizontal lines</span>
</PRE><A name=AutosizeOption>Autosizing options</A> <PRE>GVS_DEFAULT   <span class='cpp-comment'>// default </span>
GVS_HEADER    <span class='cpp-comment'>// Size using column fixed cells data only</span>
GVS_DATA      <span class='cpp-comment'>// Size using column non-fixed cells data only</span>
GVS_BOTH      <span class='cpp-comment'>// Size using column fixed and non-fixed</span>
</PRE><A name=CellMask>Cell data mask</A> <PRE>GVIF_TEXT      <span class='cpp-comment'>// Cell text will be accessed</span>
GVIF_IMAGE     <span class='cpp-comment'>// Cell image number will be accessed</span>
GVIF_PARAM     <span class='cpp-comment'>// Cell user data (lParam) will be accessed</span>
GVIF_STATE     <span class='cpp-comment'>// Cell state will be accessed</span>
GVIF_BKCLR     <span class='cpp-comment'>// Cell background colour will be accessed</span>
GVIF_FGCLR     <span class='cpp-comment'>// Cell foreground colour will be accessed</span>
GVIF_FORMAT    <span class='cpp-comment'>// Cell format field will be accessed</span>
GVIF_FONT      <span class='cpp-comment'>// Cell logical font will be accessed</span>
GVIF_MARGIN    <span class='cpp-comment'>// Cell margin information will be accessed </span>
GVIF_ALL       <span class='cpp-comment'>// All information will be accessed </span>
</PRE><A name=CellState>Cell states</A> <PRE>GVIS_FOCUSED     <span class='cpp-comment'>// Cell has focus</span>
GVIS_SELECTED    <span class='cpp-comment'>// Cell is selected</span>
GVIS_DROPHILITED <span class='cpp-comment'>// Cell is drop highlighted</span>
GVIS_READONLY    <span class='cpp-comment'>// Cell is read-only and cannot be edited</span>
GVIS_FIXED       <span class='cpp-comment'>// Cell is fixed</span>
GVIS_FIXEDROW    <span class='cpp-comment'>// Cell is part of a fixed row</span>
GVIS_FIXEDCOL    <span class='cpp-comment'>// Cell is part of a fixed column</span>
GVIS_MODIFIED    <span class='cpp-comment'>// Cell has been modified</span>
</PRE><A name=CellSearch>Cell Searching options</A> <PRE>GVNI_FOCUSED     <span class='cpp-comment'>// Search for focus cell</span>
GVNI_SELECTED    <span class='cpp-comment'>// Search for selected cells</span>
GVNI_DROPHILITED <span class='cpp-comment'>// Search for drop highlighted cells</span>
GVNI_READONLY    <span class='cpp-comment'>// Search for read-only cells</span>
GVNI_FIXED       <span class='cpp-comment'>// Search for fixed cells </span>
GVNI_MODIFIED    <span class='cpp-comment'>// Search for modified cells</span>

GVNI_ABOVE       <span class='cpp-comment'>// Search above initial cell</span>
GVNI_BELOW       <span class='cpp-comment'>// Search below initial cell</span>
GVNI_TOLEFT      <span class='cpp-comment'>// Search to the left of the initial cell</span>
GVNI_TORIGHT     <span class='cpp-comment'>// Search to the right of the initial cell</span>
GVNI_ALL         <span class='cpp-comment'>// Search all cells in the grid starting from</span>
                 <span class='cpp-comment'>// the given cell</span>
GVNI_AREA        <span class='cpp-comment'>// Search all cells below and to the right of </span>
                 <span class='cpp-comment'>// the given cell</span>
</PRE><A name=Messages>Notification messages</A> <PRE>GVN_BEGINDRAG      <span class='cpp-comment'>// Sent when dragging starts</span>
GVN_BEGINLABELEDIT <span class='cpp-comment'>// Sent when inplace editing starts</span>
GVN_ENDLABELEDIT   <span class='cpp-comment'>// Sent when inplace editing stops</span>
GVN_SELCHANGING    <span class='cpp-comment'>// Sent just before cell selection changes</span>
GVN_SELCHANGED     <span class='cpp-comment'>// Sent after cell selection changes</span>
GVN_GETDISPINFO    <span class='cpp-comment'>// A request for cell information when the grid is </span>
                   <span class='cpp-comment'>// in virtual mode</span>
GVN_ODCACHEHINT    <span class='cpp-comment'>// Cache hint when in virtual mode</span>
</PRE>
<P>These messages are exactly the same as their LVN_... counterparts, except they use an NM_GRIDVIEW structure: </P><PRE><span class='cpp-keyword'>typedef</span> <span class='cpp-keyword'>struct</span> tagNM_GRIDVIEW { 
    NMHDR hdr; 
    <span class='cpp-keyword'>int</span>   iRow; 
    <span class='cpp-keyword'>int</span>   iColumn; 
} NM_GRIDVIEW;
</PRE>
<H2><A name=Overrides>Protected overridable functions</A></H2>
<P>These functions have been made virtual to aid extensiblity. 
<P><B>Printing</B> - called in OnPrint. </P><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> PrintColumnHeadings(CDC *pDC, CPrintInfo *pInfo);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> PrintHeader(CDC *pDC, CPrintInfo *pInfo); 
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> PrintFooter(CDC *pDC, CPrintInfo *pInfo);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> PrintRowButtons(CDC *pDC, CPrintInfo* pInfo);</PRE>
<P><B>Drag n' drop</B> </P><PRE><span class='cpp-comment'>// No longer necessary but I thought the code was cool so kept it :).</span>
<span class='cpp-keyword'>virtual</span> CImageList* CreateDragImage(CPoint *pHotSpot)  </PRE>
<P><B>Mouse Clicks</B> </P><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnFixedColumnClick(CCellID&amp; cell);
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnFixedRowClick(CCellID&amp; cell);</PRE>
<P><B>Editing</B> </P><PRE><span class='cpp-comment'>// Starting edit</span>
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEditCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, CPoint point, 
                        UINT nChar) 
<span class='cpp-comment'>// ending edit</span>
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEndEditCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol, CString str) 
<span class='cpp-comment'>// Create the inplace edit control</span>
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> CreateInPlaceEditControl(CRect&amp; rect, DWORD dwStyle, 
                                      <span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol,
                                      LPCTSTR szText, <span class='cpp-keyword'>int</span> nChar)</PRE>
<P><B>Drawing</B> </P><PRE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnDraw(CDC&amp; origDC);  <span class='cpp-comment'>// Draws everything</span></PRE>
<P><B>Construction and Cleanup</B> </P><PRE><span class='cpp-comment'>// Creates a new cell and initialises it.</span>
<span class='cpp-keyword'>virtual</span> CGridCellBase* CreateCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)
                                                     
<span class='cpp-comment'>// Destroys a cell and performs any cleanup necessary</span>
<span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> DestroyCell(<span class='cpp-keyword'>int</span> nRow, <span class='cpp-keyword'>int</span> nCol)</PRE>
<H2><A name=Clipboard>Clipboard</A></H2>
<P>A number of Clipboard functions have been included.<BR>
<TABLE cellSpacing=0 cellPadding=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEditCut()</CODE> </TD>
<TD class=smallText width="100%">Copies contents of selected cells to clipboard and deletes the contents of the selected cells. (Ctrl-X)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEditCopy()</CODE> </TD>
<TD class=smallText width="100%">Copies contents of selected cells to clipboard. (Ctrl-C)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEditPaste()</CODE> </TD>
<TD class=smallText width="100%">Pastes the contents of the clipboard to the grid. (Ctrl-V)</TD></TR>
<TR vAlign=top>
<TD noWrap><CODE><span class='cpp-keyword'>virtual</span> <span class='cpp-keyword'>void</span> OnEditSelectAll()</CODE> </TD>
<TD class=smallText width="100%">Not actually a clipboard function, but handy nevertheless. This routine selects all cells in the grid. (Ctrl-A)</TD></TR></TBODY></TABLE>
<H2><A name=EditValidate>Cell Editing and Validation</A></H2>
<P>There are several ways you can control whether or not cells can be edited, or indeed whether or not changes to cells should be accepted or rejected. 
<P>The simplest is to use <CODE>SetEditable(BOOL)</CODE>. This determines whether or not the cells in the grid can be edited. Finer scale control can be achieved by setting the <CODE>GVIS_READONLY</CODE> flag on a particular cell: </P><PRE><span class='cpp-keyword'>int</span> row = <span class='cpp-literal'>1</span>;
<span class='cpp-keyword'>int</span> col = <span class='cpp-literal'>10</span>;
m_Grid.SetItemState(row,col, m_Grid.GetItemState(row,col) | GVIS_READONLY);</PRE>
<P>Further control can be achieved by handling the <CODE>GVN_BEGINLABELEDIT</CODE> message. If the return value for this message is &lt; 0 then the edit attempt for the given cell will be rejected and the cell will be treated as read-only. This message is sent each time an edit attempt is made on a cell. 
<P>To handle the message, add a handler in your main window: </P><PRE>BEGIN_MESSAGE_MAP(CGridCtrlDemoDlg, CDialog)
	...
	<span class='cpp-comment'>// Add a handler</span>
	ON_NOTIFY(GVN_ENDLABELEDIT, IDC_GRID, OnGridEndEdit)
END_MESSAGE_MAP()

...

<span class='cpp-comment'>// GVN_ENDLABELEDIT</span>
<span class='cpp-keyword'>void</span> CGridCtrlDemoDlg::OnGridStartEdit(NMHDR *pNotifyStruct, 
                                       LRESULT* pResult)
{
    NM_GRIDVIEW* pItem = (NM_GRIDVIEW*) pNotifyStruct;
    
    <span class='cpp-comment'>// AllowCellToBeEdited is a fictional routine that should return TRUE </span>
    <span class='cpp-comment'>// if you want to allow the cell to be edited.</span>
    BOOL bAllowEdit = AllowCellToBeEdited(pItem-&gt;iRow, pItem-&gt;iColumn);

    *pResult = (bAllowEdit)? <span class='cpp-literal'>0</span> : -<span class='cpp-literal'>1</span>;
}
</PRE>
<P>Accepting or rejecting the new edited value for the cell can be achieved by handling the <CODE>GVN_ENDLABELEDIT</CODE> message in the same way </P><PRE><span class='cpp-comment'>// GVN_ENDLABELEDIT</span>
<span class='cpp-keyword'>void</span> CGridCtrlDemoDlg::OnGridEndEdit(NMHDR *pNotifyStruct, 
                                     LRESULT* pResult)
{
    NM_GRIDVIEW* pItem = (NM_GRIDVIEW*) pNotifyStruct;
    
    <span class='cpp-comment'>// AcceptChange is a fictional routine that should return TRUE</span>
    <span class='cpp-comment'>// if you want to accept the new value for the cell.</span>
    BOOL bAcceptChange = AcceptChange(pItem-&gt;iRow, pItem-&gt;iColumn);

    *pResult = (bAcceptChange)? <span class='cpp-literal'>0</span> : -<span class='cpp-literal'>1</span>;
}
</PRE>
<P>The final validation method you can use is to derive a new <CODE>CGridCellBase</CODE> class and override the <CODE>ValidateEdit</CODE> method. If this method returns TRUE then the edit is accepted, otherwise the edit is rejected. 
<H2><A name=Acknowledgements>Acknowledgements</A></H2>
<P>This would not have been possible without the following authors making their code freely available: 
<UL>
<LI><A href="mailto:chinajoe@aol.com">Joe Willcoxson</A>: Joe's original code spurred this project on, and provided the basic structure of this grid control. 
<LI><A href="mailto:keithr@europa.com">Keith Rule</A>: Keith provided a neat CMemDC class to make flicker free display simple, and provided sample OLE copy/paste/drag/drop code. 
<LI><A href="mailto:rreddy@braintech.com">Ravi Reddy</A>: I used a derivation of Ravi's listview printing code. 
<LI><A href="mailto:zafir@home.com">Zafir Anjum</A>: Provided the starting point for my CInPlaceEdit, the sorting routines and the TitleTip code. 
<LI>Eric Woodruff, Brian V. Shifrin, Scot Reed, Aqiruse, Ken Bertelson, Martin Daly for updates to the version 2.X classes - plus all the dozens that helped with previous versions. 
<LI>All those who freely contribute code to one another</A>: Without you all I would not have been able to write this. 
<LI>All those who sent in bug reports, suggestions, improvements and encouragement. Thank you!</LI></UL>
<H2><A name=History>History</A></H2>
<TABLE cellSpacing=5 width="100%">
<TBODY>
<TR vAlign=top>
<TD noWrap><B>Version</B></TD>
<TD><B>Comments</B></TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><B>1.0 - 1.13</B><BR>20 Feb 1998 - 6 May 1999</TD>
<TD class=smallText>First release version. Progressed from being a basic grid based on the original WorldCom Grid control written by Joe Willcoxson (mailto:chinajoe@aol.com, http://users.aol.com/chinajoe) to something a little more feature rich. Rewritten so many times I doubt there is a single line of Joe's code left. Many, many, MANY people sent in bug reports and fixes. Thank you all. </TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.0</B><BR>16 Feb 2000</TD>
<TD class=smallText>Rewritten to make the grid more object oriented, in that the CGridCell class now takes care of cell-specific tasks. This makes the code more robust, but more importantly it allows the simple insertion of other types of cells. Most of the bugs in the previous version have been fixed, especially the "ExpandToFit" functions and the cell selection/focus. I expect I've introduced a bunch more :)</TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.01</B><BR>23 Feb 2000</TD>
<TD class=smallText>Fixes by Eric Woodruff, &lt;Eric_Woodruff@compuserve.com&gt;<BR>Minor MemDC fix, In-place edit WM_KILLFOCUS, "PrintCell" added to CGridCell, plus changes to CGridCell::Draw. Added GetCellTextExtent, SetItemTextFmt to CGridCtrl + better print support. OnRButtonUp handler. various Clipboard and key handling fixes. Search for EFW. </TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><A name=New><B>2.02</B><BR></A>29 Feb 2000 </TD>
<TD class=smallText>Brian V. Shifrin, Scot Reed<BR>Fixes to reduce flicker, fix font selection bug, Fixed SetFixed[Row/Col]Count bug</TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.10</B><BR>11 Mar 2000 </TD>
<TD class=smallText>Ken Bertelson, Aqiruse and Chris Maunder<BR>Titletips now use cell color<BR>More attribute accessor functions, plus previously private functions now public<BR>Additions for virtual CGridCell support of embedded tree &amp; cell buttons implementation<BR>Optional WYSIWYG printing<BR>Awareness of hidden (0 width/height) rows and columns for key movements, cut, copy, paste, and autosizing<BR>CGridCell can make title tips display any text rather than cell text only<BR>Minor vis bug fixes<BR>CGridCtrl now works with CGridCellBase instead of CGridCell. This is a taste of things to come.<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.11</B><BR>19 May 2000 </TD>
<TD class=smallText>Chris Maunder + Co<BR>Increasing fixed cells clashed with selected cells (Ivan Ilinov)<BR>AutoSizeRows obvous bug fixed<BR>OnLButtonDown fix (Ken Bertelson) <BR>ExpandToFit bug fixed (scrollbar space) (Igor Proskuriakov)<BR>List mode selection/deselection fixed<BR>Keyboard cell movement improved. You can now see the cells!<BR>m_nBarState MS madness fixed (Phil K)<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.12</B><BR>26 May 2000 </TD>
<TD class=smallText>Martin Richter's fixes:<BR>If using TRY/CATCH (winCE) instead of try/catch (win32), e-&gt;Delete is not called<BR>EnsureVisible "fix" was fixed properly.<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.13</B><BR>28 May 2000 </TD>
<TD class=smallText>Chris Maunder, Martin Richter, Ken Bertelson<BR>AutoSizeColumn works on either column header, data or both<BR>EnsureVisible. The saga continues.<BR>Rewrote exception handling<BR>Added the Get/EnableColumnHide and Get/EnableRowHide functions<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.20</B><BR>29 July 2000</TD>
<TD class=smallText>Font storage optimised (suggested by Martin Richter)<BR>AutoSizeColumn works on either column header, data or both<BR>EnsureVisible. The saga continues... (Ken)<BR>Rewrote exception handling<BR>Added TrackFocusCell and FrameFocusCell properties, as well as ExpandLastColumn (suggested by Bruce E. Stemplewski).<BR>InsertColumn now allows you to insert columns at the end of the column range (David Weibel)<BR>Shift-cell-selection more intuitive<BR>API change: Set/GetGridColor now Set/GetGridLineColor<BR>API change: Set/GetBkColor now Set/GetGridBkColor<BR>API change: Set/GetTextColor, Set/GetTextBkColor depricated <BR>API change: Set/GetFixedTextColor, Set/GetFixedBkColor depricated <BR>Stupid DDX_GridControl workaround removed.<BR>Added "virtual mode" via Set/GetVirtualMode<BR>Added SetCallbackFunc to allow callback functions in virtual mode<BR>Added Set/GetAutoSizeStyle<BR>AutoSize() bug fixed<BR>added GVIS_FIXEDROW, GVIS_FIXEDCOL states<BR>added Get/SetFixed[Row|Column]Selection<BR>cell "Get" methods now const'd. Sorry folks...<BR>GetMouseScrollLines now uses win98/W2K friendly code<BR>WS_EX_CLIENTEDGE style now implicit<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.21</B><BR>30 Aug 2000</TD>
<TD class=smallText>re-jigged OLE initialisation and drag/drop registration<BR>Cut and Paste bug fixed (empty cells not being treated correctly)<BR>Added "bExpandFixed" parameter to Expand*ToFit functions (Hans-Peter Werner)<BR>SetRedraw bug fixed<BR>Resizing 0-width last row and column now works<BR>Fixed CreateCell SetFormat bug (Loic Baudry)<BR>Fixed GetFixedTextColor typo (raybie@Exabyte.COM)<BR>Modified EnableScrollBars calls in Expand*ToFit functions (Simon Hughes)<BR>GetCellFromPt now public<BR>GV_CACHEHINT sent more appropriately, and also sent with -1 cellrange at the end of operations (so App can discard data - Martin Richter)<BR>CGridCellBase::operator= checks for NULL font before setting (Martin Richter)<BR>After drag/drop, mouse button was still marked as "down". Fixed.<BR></TD>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.22</B><BR>1 Jan 2001</TD>
<TD class=smallText>SetModified bug in SetItem (Keith Worden)<BR>ifdef around SetItemTextFmt corrected for win32<BR>Save() bug fixed (row 0 saved twice)<BR>GetTopleftNonFixedCell, GetUnobstructedNonFixedCellRange and GetVisibleNonFixedCellRange have optional parameter to force recalc.<BR>added virtual ValidateEdit.<BR>if the return value from the SendMessage operation for GVN_ENDLABELEDIT or GVN_BEGINLABELEDIT is &lt; 0 then the edit, or the attempt to edit (respectively) is rejected.<BR>Added GetEditWnd to CGridCellBase<BR>Fixed the paste bug for cells being edited (Gary Lyben).<BR>GVN_SELCHANGING/GVN_SELCHANGED messages now sent correctly<BR>OnRButtonUp was not handling clicks on fixed cells correctly<BR>SB_ENDSCROLL message now sent on keypress initiated scroll<BR>GetCellTextExtent bug fixed (Elco)<BR>SetSelectedRange inefficiency fixed by huangchaoyi (ahaa007@263.net)<BR>DT_NOCLIP removed from CGridCellBase::Paint<BR>SetRowCount returns correct value on OOM condition (asigal@hotmail.com)<BR>Bug when editing using Japanese characters fixed (Michael Dunn)<BR>Fixed columns and rows printed correctly (fletch - untested)<BR>Added the "ClearCells" function<BR>Added the "SetCompareFunction" function and revamped sorting<BR>Added "GetEditWnd()" to CGridCellBase<BR>Added "GetTipText" to CGridCellBase<BR>
<TR>
<TD class=smallText vAlign=top noWrap><B>2.23</B><BR>22 July 2001</TD>
<TD class=smallText>Save/Load now take optional second parameter to set separator character<BR>When in list mode, fixed columns are no longer editable<BR>Combobox grid cells now auto-resize correctly<BR>Cells are printed using printer font, not screen font (Laura Michaels)<BR>ExpandLastColumn fixed (Jim Arnold)<BR>When entering DBCS chars into cells the first char was being lost (KiteFly)<BR>EnsureVisible no longer steals the focus (Damir)<BR>Ctrl+mouse-click no longer puts a cell into edit mode (useful for unselecting) (Richard Bouwman)<BR>SetModified/GetModified wasn't handling the first row or column (Ivan Melnychuk)<BR>GetCellFromPt Fixed cell check bug fixed (Jim Arnold)<BR>Plus a few nips and tucks (Simon Hughes and others)<BR>SetItem bug when setting select state fixed (Mik)<BR>ComboCell draw error (Joanna Sadler)<BR>NULL pointer reference bug fixed in GetTextRect (Jim Arnold)<BR>Drag/Drop handler functions now virtual<BR>Print() now accepts a pointer to a CPrintDialog object, so you can use your own print dialog when printing (Andrew Truckle)<BR>Cell drawing now uses CGridCellBase::GetTextExtent, which simplifies drawing logic for derived classes that embed controls. See the Checkbox cell for more info<BR>ValidateAndModifyCellContents no longer modifies read-only cells<BR>Drag and drop can now start from read-only cells (Jim Arnold)<BR>ResetScrollBars fixed (not fully checked though) - Paul Runstedler<BR>EraseBkgnd vis problem fixed (Sean McKinnon)<BR>ExpandLastColumn, ExpandRowsToFit and ExpandColumnsToFit now respect hidden rows/columns.<BR><B>Thanks to Podsypalnikov Eugen</B> for the DateTimeCtrl cell type. </TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><B>2.24</B><BR>4 July 2002</TD>
<TD class=smallText>Corrected compile errors in Visual C++ .NET<BR>Added CGridCellNumeric cell type - Andrew Truckle<BR>Selecting cells using the keyboard sends GVN_SELCHANG* messages to the parent - Arthur Westerman/Scot Brennecke<BR>When printing, the cells now use the grid's default cell colour unless otherwise specified<BR>Tabbing over hidden rows now works correctly<BR>EnsureVisible bug where NULL pFocusWnd was being used fixed - Patrick DellEra<BR>Client border now shows at startup even if size if cells is smaller than size of grid client area<BR>CGridCellBase members pure virtual - Scot Brennecke<BR>Minor code cleanups and clarifications<BR>Minor speed improvements (eg Optimised OnDraw for invisible cells)<BR>Pasted cells now set as selected<BR>Clicking on a fixed row no longer sets a focus cell (David Pritchard)<BR>DEL key now clears all selected cells </TD></TR>
<TR vAlign=top>
<TD class=smallText noWrap><A name=New><B>2.25</B><BR></A>13 Mar 2004</TD>
<TD class=smallText>Minor changes so it will compile in VS.NET 2003 and Whidbey<BR>Fixed minor bug in EnsureVisible - Junlin Xu<BR>Changed AfxGetInstanceHandle for AfxGetResourceHandle in RegisterWindowClass<BR>Various changes thanks to Yogurt</TD></TR></TBODY></TABLE>

<!-- Article Ends -->

</div>

<script language="javascript" DEFER>Highlight(Array());</script>
<h2>About Chris Maunder</h2>
<table width='100%' border=0><tr valign=top><td nowrap class=smallText ><img src='/script/profile/images/{BB692055-05E8-418C-8481-E56773098B3C}.jpg'><br><br><img src='/script/images/admin_ico.gif' align=absbottom> Site Admin<br><img src='/script/images/admin_modify.gif' align=absbottom> Editor<br><img src='/script/images/sitebuild_icon.gif'> Site Builder</td><td class=smallText width='100%'>Chris is the Co-founder, Administrator, Architect, Chief Editor and Shameless Hack who wrote and runs CodeProject. He's been programming since 1988 while pretending to be, in various guises, an astrophysicist, mathematician, physicist, hydrologist, geomorphologist, defence intelligence researcher and then, when all that got a bit rough on the nerves, a web developer. He is a Microsoft Visual C++ MVP both globally and for Canada locally. <br><br>His programming experience includes C/C++, C#, MFC, ASP, ASP.NET, and far, far too much FORTRAN. He has worked on PocketPCs, AIX mainframes, Sun workstations, and a CRAY YMP C90 behemoth but finds notebooks take up less desk space.<br><br>He dodges, he weaves, and he never gets enough sleep. He is kind to small animals.<br><br>Chris was born and bred in Australia but is currently based in Toronto enjoying the weather. For relaxation he is into snowboarding, rock climbing, mountain biking, and storm chasing.<br><p class=smallText>Click <a href='/script/profile/whos_who.asp?vt=arts&id=1'>here</a> to view Chris Maunder's online profile.</p></td></tr></table><br><table cellpadding=4 width='100%' border=0><tr valign=top><td width='100%'><h2>Other popular  articles:</h2><ul><li><a href="/miscctrl/umleditor.asp">UMLEditor - revisiting the vector editor</a><br><span class=smalltext>An UML editor with code-generation capabilities derived from CDiagramEditor.</span><li><a href="/miscctrl/minicalendar.asp">MS Outlook style miniature calendar control</a><br><span class=smalltext>A custom CWnd derived control which simulates the functionality of the MS Outlook mini calendar control.</span><li><a href="/miscctrl/uucolorpicker.asp">A color picker dialog with a color dropper like Photoshop and Frontpage 2000</a><br><span class=smalltext>A color picker and dropper that extends the standard Windows dialogs to behave like Photoshop or Frontpage 2000</span><li><a href="/miscctrl/gradient.asp">CGradient and CGradientCtrl</a><br><span class=smalltext>A pair of classes for rendering and editing colourful washes</span></ul></td><td width=360><script language=javascript>document.write("<IFRAME src=\"/script/admentor/include/ServeAdHTML.aspx?C=False&id=786\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</script></td></tr></table>
		<form action="/script/rating/code/app/insert_vote.asp" method="post">
		<input type="hidden" name="vote_name" value="/miscctrl/gridctrl.asp">
		<input type="hidden" name="goal" value="/miscctrl/gridctrl.asp">

<table bgColor=#ff9900 border=0 cellPadding=1 cellSpacing=0 width="100%">
<tr><td width="100%">
<table bgColor=#FBEDBB border=0 cellPadding=4 cellSpacing=0 width="100%"><tr>
<td valign=middle class=smalltext>[<a href="#__top">Top</a>]</td>
<td align=right valign=middle nowrap >
<a href='/script/profile/logon.asp?ct=%2Fmiscctrl%2Fgridctrl%2Easp'><b>Sign in</b></a> to vote for this article:&nbsp;&nbsp;&nbsp;&nbsp; <i>Poor</i><input type=radio value='1' style='disabled:true;' name=rate><input type=radio value='2' style='disabled:true;' name=rate><input type=radio value='3' style='disabled:true;' name=rate><input type=radio value='4' style='disabled:true;' name=rate><input type=radio value='5' style='disabled:true;' name=rate><i>Excellent</i>&nbsp;&nbsp;<input type=submit value=Vote class=FormButton style='disabled:true;'>
</td></tr>
</table></td></tr></table>
</form>
<table width=100% cellspacing=0 cellpadding=0 border=0><tr valign=top>
<td valign=top><center><script language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1283&way=ban\" target=_blank><img src=\"/script/admentor/include/ServeAd.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FSekos%5F120x60%5FAgileStudioButton%2Egif&C=False&id=1283\" alt=\"AgileStudio Addin for Visual Studio.net						\" border=0 width=120 height=60></a>");</script></center><br></td>
<td valign=top nowrap align=center><span id=AdBanner5><script language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=648&way=ban\" target=_blank><img src=\"/script/admentor/include/ServeAd.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvsnet468x60%5Fmfc%2Egif&C=False&id=648\" alt=\"Support Code Project and purchase Visual Studio .NET from $899\" border=0 width=468 height=60></a>");</script></span></td>
</tr></table>

</td></tr></table>

<a name='__comments'></a>

<script language="JavaScript">

var Selected = "";
var AdTime = new Date();

function SwitchMessage(elm)
{
	
	var elmref;
	if (Selected != "")
	{
		elmref = eval("document.getElementById('" + Selected + "_h1')");
		if (elmref) elmref.style.display = 'none';
		elmref = eval("document.getElementById('" + Selected + "_h0')");
		if (elmref) elmref.bgColor = '#FEF9E7';
	}
	if (Selected != elm.name) 
	{
		Selected = elm.name;
		elmref = eval("document.getElementById('" + Selected + "_h1')");
		if (elmref) 
		{
			if (elmref.style.display=='none') elmref.style.display='';
			else elmref.style.display = 'none';
		}
		elmref = eval("document.getElementById('" + Selected + "_h0')");
		if (elmref) 
			elmref.bgColor = '#99CCFF';
	}
	else
		Selected="";

	return false;
}

function SwitchThisMessage()
{
	return SwitchMessage(this);
}

</script>
<table border=0 bgcolor='#ff9900' width=100% cellpadding=0 cellspacing=0><tr><td width='100%'><table border=0 id=ForumTable bgcolor='#ff9900' width=100% cellpadding=0 cellspacing=1><form action='/script/comments/app/do_filtermessages.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18' method=post><tr><td><table width=100% bgcolor=white border=0 cellspacing=0 cellpadding=3><tr bgcolor=#FBEDBB><td nowrap class=smalltext><a href='/script/comments/faq.asp'><img src='/script/images/forum_faq.GIF' border=0 width=16 height=16 align=absmiddle> <b>FAQ</b></a>&nbsp;</td><td nowrap valign=top align=right class=smalltext>Noise tolerance <select size=1 name=noise class=smalltext><option value="1">Very High</option>
<option value="2">High</option>
<option selected value="3">Medium</option>
<option value="4">Low</option>
<option value="5">Very low</option>
</select>&nbsp;&nbsp;</td><td class=smalltext nowrap align=right valign=middle colspan=2><a href='/script/comments/search_comments.asp?forumid=18'><img src="/script/images/forum_search.gif" width=16 height=15 border=0> Search comments</a> &nbsp;</td><td valign=top align=right><input type=submit value='Set Options' name=submit class=FormButton></td></tr><tr bgcolor='#ff9900'><td width='100%'>&nbsp;</td><td nowrap align=right valign=top class=smalltext>View <select size=1 name=expand class=smalltext><option value="0">Normal (slow)</option>
<option value="2">Preview (slow)</option>
<option selected value="5">Message View</option>
<option value="6">Topic View</option>
<option value="1">Thread View</option>
<option value="3">Expanded (Supporters only)</option>
</select>&nbsp;&nbsp;</td><td nowrap valign=top class=smalltext>Per page <select size=1 name=perpage class=smalltext><option value="10">10</option>
<option selected value="25">25</option>
<option value="50">50 (must logon)</option>
</select></td><td colspan=2>&nbsp;</td></tr></table>
</td></tr></form><tr bgcolor=#FBEDBB><td><a name=xx0xx></a><table border=0 cellpadding=2 width=100% bgcolor=#FBEDBB><tr><td class=messagetitle><img src='/script/images/forum_newmsg.gif' width=16 height=16 border=0 align=top><a href='/script/comments/user_new.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18'  class=HoverLink  target=_top name=HoverNL title='Add a new message to the discussions'><b>New Message</b></a></td><td class=messagetitle>Msgs 1 to 25 of 2325 (Total: 2326) (<a href='/miscctrl/gridctrl.asp?df=100&forumid=18'>Refresh</a>)</td><td align=right nowrap><font class=messagetitle><span class=HoverLink >First</span> <span class=HoverLink >Prev</span> <a class=HoverLink name=HoverNL href='/miscctrl/gridctrl.asp?df=100&forumid=18&fr=26'>Next</a> <span class=HoverLink >&nbsp;&nbsp;&nbsp;&nbsp;</span> </font></td></tr></table>
</td></tr><tr bgcolor=white><td><table border=0 cellspacing=0 cellpadding=0 width='100%' border=0><tr><td width='70%' colspan=2 bgcolor=#FBEDBB><table border=0 cellspacing=0 cellpadding=2 width='100%'><tr><td class=messagetitle>Subject&nbsp;</td></tr></table></td><td width=140 bgcolor=#FBEDBB><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img src='/script/images/t.gif' border=0 width=1 height=1></td></tr><tr><td class=messagetitle>Author&nbsp;</td></tr><tr><td><img src='/script/images/t.gif' border=0 width=1 height=1></td></tr></table></td><td width='12%' bgcolor=#FBEDBB><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img src='/script/images/t.gif' border=0 width=1 height=1></td></tr><tr><td align=right class=messagetitle>Date&nbsp;</td></tr><tr><td><img src='/script/images/t.gif' border=0 width=1 height=1></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr bgcolor='#FEF9E7' id=1259674_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1259674xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1259674 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1259674#xx1259674xx'><b>Checkbox cell clicking bug</b></a></td></tr></table></td><td valign=bottom><img src='/script/images/usersuss.gif' alt='Unconfirmed/Anonymous posting' width=15 height=13></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle color ='#707070'><b>S.C.W.</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle color ='#707070'><b>14hrs 31mins  ago</b>&nbsp;</font></td></tr>
<tr id=1259674_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>In the demo, I changed the cell type of cell (1,1) to "Checkbox type". I clicked the cell (not in the checkbox itself, but the text in the cell). I then clicked the background area of the GridCtrl.<br><br>An assertion failed in the function OnLButtonUp() at the line:<br> pCell->&#x6f;nclick( GetPointClicked( m_idCurrentCell.row, m_idCurrentCell.col, point) );<br><br>Since I clicked in the background area, either the m_idCurrentCell.col or m_idCurrentCell.col should be -1. But they were not. m_idCurrentCell was still pointing to the check box cell.<br><br>I think this should be easy to fix.<br><br>This bug is repeatable. I ain't sure if someone has posted it here before though. <br><br><br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259674' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259674'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1259674&forumid=18&select=1259674#xx1259674xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1259674#xx1259674xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259674'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259674'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1259521_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1259521xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1259521 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1259521#xx1259521xx'><b>Messages from CGridCtl to Parent Window</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=2073681'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>chizhan</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>19hrs 13mins  ago</b>&nbsp;</font></td></tr>
<tr id=1259521_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Hi.<br>How I can to work at messages from CGridCtl object in parent window.<br>I want it for &#x6f;nkeydown message.<br>Thanks. <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259521' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259521'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1259521&forumid=18&select=1259521#xx1259521xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1259521#xx1259521xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259521'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1259521'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1249961_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1249961xx'></a><img align=absmiddle src='/script/images/news_question.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1249961 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1249961#xx1249961xx'><b>How to scroll to bottom of grid?</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=319503'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>HumanJHawkins</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>22:49 10 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1249961_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Hi,<br><br>I use this control to hold a log of results a program has returned. I want to keep it in top to bottom order (i.e. insert new entries at the bottom).<br><br>How can I automatically scroll to the bottom of the grid after inserting a new row? I searched for "scroll" and read several pages of posts without finding this.<br><br>Thanks! <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249961' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249961'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1249961&forumid=18&select=1249961#xx1249961xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1249961#xx1249961xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249961'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249961'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1252118_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1252118xx'></a><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_answer.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1252118 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1252118#xx1252118xx'>Re: How to scroll to bottom of grid? (and repost of revised sort routine)</a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=319503'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >HumanJHawkins&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >1:58 13 Oct '05&nbsp;</font></td></tr>
<tr id=1252118_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent><Response to private message that I think is appropriate to answer here><br><br>About scrolling to the bottom: What I have so far is to use this:<br><code>m_GridLog.EnsureVisible(m_ctmMessenger.m_GridLog.GetRowCount(), 0);</code><br><br>However, there seem to be a few problems with the EnsureVisible function still... It works in release mode, but gives assertions in debug mode.<br><br>About the replacement sort routine: Please note that this is NOT faster than the normal included sort routine. Actually it is a bit slower. However, it resolves what I consider to be a bug in the normal routine where previous sort order is unnecessarily thrown out.<br><br>In other words, with this routine you can sort by column "C", then "B", then "A" and you will get a true multi-tiered sort. This is the reason for the revised routine, not speed. Here's the code... Just comment out the function with the exact same parameters and paste this in to replace it:<br><code>BOOL CGridCtrl::SortItems(PFNLVCOMPARE pfnCompare, int nCol, BOOL bAscending, LPARAM data, int iStartRow, int iEndRow)<br>{<br>	if(iEndRow == -1)	<br>	{<br>		iEndRow = GetRowCount() - 1;<br>	}<br><br>	// Return false on invalid parameters	<br>	if(iEndRow <= iStartRow || nCol >= GetColumnCount())	<br>	{<br>		return FALSE;<br>	}<br><br>	int iCurrentRow;<br>	int iCompareRow;<br>	int iReverseCurrentRow;<br>	int iReverseCompareRow;<br><br>	if(bAscending)	<br>	{<br>		for(iCurrentRow = iStartRow; iCurrentRow < iEndRow; iCurrentRow++)<br>		{<br>			iCompareRow = iCurrentRow + 1;<br><br>			// If the compare row is properly sorted, skip to the next.<br>			if(pfnCompare((LPARAM)GetCell(iCurrentRow, nCol), (LPARAM)GetCell(iCompareRow, nCol), data) < 0)<br>			{<br>				continue;<br>			}<br><br>			// Every row less than iCompareRow is sorted correctly, so<br>			//   step back to find where iCompareRow should be moved to.<br>			iReverseCurrentRow = iCompareRow;<br>			iReverseCompareRow = iReverseCurrentRow - 1;<br>			while((pfnCompare((LPARAM)GetCell(iReverseCompareRow, nCol), (LPARAM)GetCell(iReverseCurrentRow, nCol), data) > 0) &&<br>				(iReverseCompareRow >= iStartRow))<br>			{<br> 				// While the row is out of place, move it up...<br>				for (int col = 0; col < GetColumnCount();  col++)<br>				{<br>					CGridCellBase *pCell = GetCell(iReverseCurrentRow, col);<br>					SetCell(iReverseCurrentRow, col, GetCell(iReverseCompareRow, col));<br>					SetCell(iReverseCompareRow, col, pCell);<br>				}<br><br>				UINT nRowHeight = m_arRowHeights[iReverseCurrentRow];<br>				m_arRowHeights[iReverseCurrentRow] = m_arRowHeights[iReverseCompareRow];<br>				m_arRowHeights[iReverseCompareRow] = nRowHeight;<br>				iReverseCurrentRow -= 1;<br>				iReverseCompareRow -= 1;<br>			}<br>		}<br>	}<br>	else	<br>	{<br>		for(iCurrentRow = iEndRow;  iCurrentRow > iStartRow; iCurrentRow--)<br>		{<br>			iCompareRow = iCurrentRow - 1;<br><br>			// If the compare row is properly sorted, skip to the next.<br>			if(pfnCompare((LPARAM)GetCell(iCurrentRow, nCol), (LPARAM)GetCell(iCompareRow, nCol), data) < 0)<br>			{<br>				continue;<br>			}<br><br>			// Every row less than iCompareRow is sorted correctly, so<br>			//   step back to find where iCompareRow should be moved to.<br>			iReverseCurrentRow = iCompareRow;<br>			iReverseCompareRow = iReverseCurrentRow + 1;<br>			while((pfnCompare((LPARAM)GetCell(iReverseCompareRow, nCol), (LPARAM)GetCell(iReverseCurrentRow, nCol), data) > 0) &&<br>				(iReverseCompareRow <= iEndRow))<br>			{<br> 				// While the row is out of place, move it up...<br>				for (int col = 0;  col < GetColumnCount();  col++)<br>				{<br>					CGridCellBase *pCell = GetCell(iReverseCurrentRow, col);<br>					SetCell(iReverseCurrentRow, col, GetCell(iReverseCompareRow, col));<br>					SetCell(iReverseCompareRow, col, pCell);<br>				}<br><br>				UINT nRowHeight = m_arRowHeights[iReverseCurrentRow];<br>				m_arRowHeights[iReverseCurrentRow] = m_arRowHeights[iReverseCompareRow];<br>				m_arRowHeights[iReverseCompareRow] = nRowHeight;<br>				iReverseCurrentRow += 1;<br>				iReverseCompareRow += 1;<br>			}<br>		}<br>	}<br><br>	return TRUE;<br>}</code><br><br>Cheers! <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1252118' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1252118'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1249961&forumid=18&select=1252118#xx1252118xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1252118#xx1252118xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1252118'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1252118'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1249781_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1249781xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1249781 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1249781#xx1249781xx'><b>Why not a prize winner?</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=746950'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>Hamed Mosavi</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>16:10 10 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1249781_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I'm wondering Mr. Chris<img src="/script/images/smiley_confused.gif" align=absmiddle>, why this article did not win the prize? What make people not to give it a five?<br>Some people are very difficault!<br><br>Any way, Great great job(!) and the simplest I could do, a 5. <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249781' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249781'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1249781&forumid=18&select=1249781#xx1249781xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1249781#xx1249781xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249781'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249781'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1249826_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1249826xx'></a><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1249826 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1249826#xx1249826xx'>Re: Why not a prize winner?</a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=6556'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >Christian Graus&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >17:19 10 Oct '05&nbsp;</font></td></tr>
<tr id=1249826_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Chris runs the site, I doubt he would allow his own articles to run in the monthly contest and I think this article predates them anyhow. <br><br>Christian Graus - Microsoft MVP - C++<br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249826' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249826'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1249781&forumid=18&select=1249826#xx1249826xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1249826#xx1249826xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249826'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1249826'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1250482_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1250482xx'></a><img height=1 width=36 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1250482 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1250482#xx1250482xx'>Re: Why not a prize winner?</a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=746950'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >Hamed Mosavi&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >11:53 11 Oct '05&nbsp;</font></td></tr>
<tr id=1250482_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=36 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Ok, I understood<img src="/script/images/smiley_smile.gif" align=absmiddle><br>I think, he is prize winner any way.<img src="/script/images/smiley_wink.gif" align=absmiddle> <br><br>//This is not a signature<br>while (<b>I'm_alive</b>) {<br>   printf("<b>I Love Programming</b>");<br>}<br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250482' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250482'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1249781&forumid=18&select=1250482#xx1250482xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1250482#xx1250482xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250482'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250482'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1246430_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1246430xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1246430 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1246430#xx1246430xx'><b>Some another control</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=1882147'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>gajesh</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>6:48 6 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1246430_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I am using this grid in my application and i want some help to add some controls.<br>How can i use date calender, Histgrams, push buttons etc. controls in my application. <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1246430' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1246430'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1246430&forumid=18&select=1246430#xx1246430xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1246430#xx1246430xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1246430'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1246430'><i>Delete</i></a>]<br>Score: 2.0 (2 votes). </td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1250080_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1250080xx'></a><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1250080 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1250080#xx1250080xx'>Re: Some another control</a></td></tr></table></td><td valign=bottom><img src='/script/images/usersuss.gif' alt='Unconfirmed/Anonymous posting' width=15 height=13></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >Anonymous&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >3:33 11 Oct '05&nbsp;</font></td></tr>
<tr id=1250080_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Maybe you can reference the article in the following URL:<a http://web6.codeproject.com/miscctrl/gridtreectrl.asp" . <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250080' title='Reply to this current thread'>Reply</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1246430&forumid=18&select=1250080#xx1250080xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1250080#xx1250080xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250080'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1250080'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1245309_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1245309xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1245309 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1245309#xx1245309xx'><b>Nice Work!</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=769815'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>philophos</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>2:23 5 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1245309_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>This class is very useful,<br>i saw many people use the code tool<br>thanks for great work ,author!! <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1245309' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1245309'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1245309&forumid=18&select=1245309#xx1245309xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1245309#xx1245309xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1245309'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1245309'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1244636_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1244636xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1244636 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1244636#xx1244636xx'><b>Suspected source of memory leak fix</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=565499'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>AlmodJ</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>9:30 4 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1244636_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>While this control is an excellent piece of work, it is also quite complex and therefore bugs are not out of the realm of possibility. There is a flaw in how the control cleans up after itself, so please apply this fix to your own code. In the CtrlGrid dsstructor, the call to DestroyWindow() is done before a call to cleanup the clipboard. Guess what? DestroyWindow removes ownership the app has of the clipboard object. So you must move DestroyWindow to the bottom of the destructor block. Second problem is that if you must call FlushClipboard, you need to stick with OOP method calling convention and reference the method from it's object handle. I.E. <br>COleDataSource::FlushClipboard(); should be pSource->FlushClipboard();<img src="/script/images/smiley_biggrin.gif" align=absmiddle><br>Here is the complete destructor code block:<br>CGridCtrl::~CGridCtrl()<br>{<br>    DeleteAllItems();<br><br>#ifndef GRIDCONTROL_NO_TITLETIPS<br>    if (m_bTitleTips && ::IsWindow(m_TitleTip.GetSafeHwnd())) <br>        m_TitleTip.DestroyWindow();<br>#endif<br><br><br><br>#if !defined(GRIDCONTROL_NO_DRAGDROP) || !defined(GRIDCONTROL_NO_CLIPBOARD)<br>    // BUG FIX - EFW<br>    COleDataSource *pSource = COleDataSource::GetClipboardOwner();<br>    if(pSource)<br>        pSource->FlushClipboard();<br><br>//        COleDataSource::FlushClipboard();<br>#endif<br><br>    DestroyWindow();<br>} <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244636' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244636'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1244636&forumid=18&select=1244636#xx1244636xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1244636#xx1244636xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244636'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244636'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1244519_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1244519xx'></a><img align=absmiddle src='/script/images/news_question.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1244519 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1244519#xx1244519xx'><b>how to save or open??</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=1983088'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>msnet</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>6:52 4 Oct '05</b>&nbsp;</font></td></tr>
<tr id=1244519_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>how to save or open to/from file for every entry of gird??? <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244519' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244519'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1244519&forumid=18&select=1244519#xx1244519xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1244519#xx1244519xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244519'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1244519'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1239027_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1239027xx'></a><img align=absmiddle src='/script/images/news_question.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1239027 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1239027#xx1239027xx'><b>How to set cell type in virtual mode</b></a></td></tr></table></td><td valign=bottom><img src='/script/images/usersuss.gif' alt='Unconfirmed/Anonymous posting' width=15 height=13></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>Zandra</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>6:45 28 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1239027_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>what i have to do to set the cell type in virtual mode?<br>i'm looking for set a GV_ITEM in my struct, but i didn't find the value of the parameters to set a cell for exemple in numeric mode or datetime or combobox...<br><br>I'll become mad....<br><br>please someone can help me?<br> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1239027' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1239027'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1239027&forumid=18&select=1239027#xx1239027xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1239027#xx1239027xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1239027'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1239027'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1238586_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1238586xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1238586 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1238586#xx1238586xx'><b>Problems Setting CellType to CGridCellCheck on WinCE device</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=278602'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>Koderiter</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>17:37 27 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1238586_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I'm using the grid on a WinCE device and trying to set the Cell type to a checkbox. I have copied the code from the example app for changing the CellType to a check box, But when I compile the checkbox does not show up. I have successfully inserted a combobox to a cell, but the checkbox for some reason does not work.<br><br>Does anybody know what could be happening? Has anybody got this to work on a PocketPC or WinCE device? If so please help.<br><br>Here is some code for what I'm doing:<br><code>m_Grid.SetCellType(1,1, RUNTIME_CLASS(CGridCell));<br>m_Grid.SetItemText(1,1, _T("1"));<br>m_Grid.SetItemState(1,1, m_Grid.GetItemState(1,1) & ~GVIS_READONLY);<br>m_Grid.Invalidate();<br><br>m_Grid.SetCellType(1,1, RUNTIME_CLASS(CGridCellCheck));<br></code><br><br>The Above does not work.<br>But the below does:<br><code>m_Grid.SetCellType(1,0, RUNTIME_CLASS(CGridCell));<br>m_Grid.SetItemText(1,0, _T("1"));<br>m_Grid.SetItemState(1,0, m_Grid.GetItemState(1,0) & ~GVIS_READONLY);<br>m_Grid.Invalidate();<br><br>if (!m_Grid.SetCellType(1,0, RUNTIME_CLASS(CGridCellCombo)))<br>     return TRUE;<br><br>m_Grid.SetItemText(1,0, _T("Option 1"));<br><br>CStringArray options;<br>options.Add(_T("Option 1"));<br>options.Add(_T("Option 2"));<br>options.Add(_T("Option 3"));<br><br>CGridCellCombo *pCell = (CGridCellCombo*) m_Grid.GetCell(1,0);<br>pCell->SetOptions(options);<br>pCell->SetStyle(CBS_DROPDOWN);<br></code><br>All this code is a cut and paste from the sample App.<br><br>Any Help would be great! <br>Thanks.<br> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238586' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238586'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1238586&forumid=18&select=1238586#xx1238586xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1238586#xx1238586xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238586'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238586'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1238594_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1238594xx'></a><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1238594 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1238594#xx1238594xx'>Re: Problems Setting CellType to CGridCellCheck on WinCE device</a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=278602'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >Koderiter&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >17:48 27 Sep '05&nbsp;</font></td></tr>
<tr id=1238594_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Shortly after posting this I found the solution.<br>In the GridCellCheck.cpp file - Function CGridCellCheck::Draw(...)<br>Comment out the #ifndef _WIN32_WCE and matching #endif<br>This allows the code to draw the checkbox to be called.<br><br>If anybody see's any problem with taking this action please comment.<br><br>Thanks for the GREAT work on this control!<br><img src="/script/images/smiley_cool.gif" align=absmiddle> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238594' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238594'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1238586&forumid=18&select=1238594#xx1238594xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1238594#xx1238594xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238594'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1238594'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1229299_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1229299xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1229299 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1229299#xx1229299xx'><b>how to read from grid control of a different application.</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=2274128'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>tejaswi_teja</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>5:12 18 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1229299_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent><br>Hi,<br><br>i have encountered a problem like this. a window was given and i have to read all the diata present in that window/dialog box. it is containing many controls like edit  boxes,combo boxes e.t.c. no problem with them using WM_GETTEXT ( sending his msg from cwnd:: sendmessageam) able to read their contents. <br>But the dialogbox/window is also containing a control like grid of cells( as the tables appeaer in MS access). how to get hold of that control and how to read all the data present in that control. please provide me informatin regarding this. I will be very thankful toyou.<br><br>is there any class behind that control. i fso  how to identify it and how to use it in my application. my application is different from the one that created the window i am tring to read). <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1229299' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1229299'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1229299&forumid=18&select=1229299#xx1229299xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1229299#xx1229299xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1229299'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1229299'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1222790_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1222790xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1222790 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1222790#xx1222790xx'><b>iojkEdit Cell in Mode Virtual</b></a></td></tr></table></td><td valign=bottom><img src='/script/images/usersuss.gif' alt='Unconfirmed/Anonymous posting' width=15 height=13></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>cbnijkl</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>19:46 11 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1222790_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I need read a editable grid in virtual mode, the cell editable is always the original text.<br>Who I read a cell?<br> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1222790' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1222790'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1222790&forumid=18&select=1222790#xx1222790xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1222790#xx1222790xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1222790'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1222790'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1216958_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1216958xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1216958 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1216958#xx1216958xx'><b>Limit Text in Cells</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=2237837'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>LeMauvais1089</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>3:00 6 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1216958_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Hello,<br><br>is there any possibility to limit the length of entered text in a cell? For example, the user should not enter more then 32 chars in the cell.<br><br>TIA<br><br>best regards,<br>Frank <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1216958' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1216958'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1216958&forumid=18&select=1216958#xx1216958xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1216958#xx1216958xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1216958'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1216958'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1215479_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1215479xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1215479 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1215479#xx1215479xx'><b>CGridCellCheck. Do i do wrong or there is a bug?</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=922737'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>markoot</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>11:07 4 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1215479_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>i do:<br><br>	CGridCellBase *pCellBase=0;<br>	CGridCellCheck *pCellCheck=0;<br>m_ctlGrid.SetCellType(0, 0, RUNTIME_CLASS(CGridCell));<br>m_ctlGrid.SetItemState(0, 0, m_ctlGrid.GetItemState(0, 0) & ~GVIS_READONLY);<br>			m_ctlGrid.Invalidate();<br>m_ctlGrid.SetCellType(0, 0, RUNTIME_CLASS(CGridCellCheck));<br>//i think this code below is not good<br>			pCellBase=m_ctlGrid.GetCell(0, 0);<br>			pCellCheck=(CGridCellCheck*)pCellBase;<br>			pCellCheck->SetCheck(pBut->GetCheck());<br>//and when i use DeleteAllItems() there is access violation in <br>delete GetCell();<br>If i dont use pCellCheck->SetCheck(pBut->GetCheck());<br>the error is not show<br><br>Thanks for help<br>Best Greetings<br>Michal <br><br>df<br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1215479' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1215479'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1215479&forumid=18&select=1215479#xx1215479xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1215479#xx1215479xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1215479'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1215479'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1214858_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1214858xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1214858 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1214858#xx1214858xx'><b>Memory Leak ???</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=1614041'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>ana_v123</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>3:15 3 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1214858_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>With downloaded demo, when I compile debug version and execute demo, I am getting memory leaks on both of the following environments. Also thread exit code comes 2 (0x2)<br><br>Environment 1:<br>	Window 98 SE<br>	Internet Explorer 6.0<br>	Visual studio 6.0 (SP5)<br>	With as well as without Platform SDK Windows 2003 Installed<br><br>Environment 2:<br>	Window 2000 Server<br>	Internet Explorer 6.0<br>	Visual studio 6.0 (SP5)<br>	With as well as without Platform SDK Windows 2003 Installed<br><br><br>For checking/testing, when I added file LeakDetection.cpp which I downloaded from<br>http://www.many-monkeys.com/downloads/LeakDetection.cpp<br><br>// LeakDetection.cpp: implementation of the CLeakDetection class.<br>//<br>//////////////////////////////////////////////////////////////////////<br><br>#include "stdafx.h"<br>#include <crtdbg.h><br><br>class CLeakDetection  <br>{<br>public:<br>	CLeakDetection();<br>	virtual ~CLeakDetection();<br><br>};<br><br>//////////////////////////////////////////////////////////////////////<br>// Construction/Destruction<br>//////////////////////////////////////////////////////////////////////<br>CLeakDetection g_LeakDetection;<br><br>CLeakDetection::CLeakDetection()<br>{<br>	_CrtCheckMemory();<br>}<br><br>CLeakDetection::~CLeakDetection()<br>{<br>	_CrtDumpMemoryLeaks();<br>}<br><br><br>I compiled debug version and run with F5 and then just closes Demo app then<br>Output Window shows as follows:<br><br>Detected memory leaks!<br>Dumping objects -><br>{70} client block at 0x00301040, subtype 0, 64 bytes long.<br>a CDynLinkLibrary object at $00301040, 64 bytes long<br>{65} client block at 0x003011C0, subtype 0, 64 bytes long.<br>a CDynLinkLibrary object at $003011C0, 64 bytes long<br>{63} client block at 0x003012E0, subtype 0, 64 bytes long.<br>a CDynLinkLibrary object at $003012E0, 64 bytes long<br>Object dump complete.<br>The thread 0x5E8 has exited with code 2 (0x2).<br>The thread 0x1C8 has exited with code 2 (0x2).<br>The program 'K:\Temp\gridctrl_demo225\Debug\GridCtrlDemo.exe' has exited with code 2 (0x2).<br><br><br>Why this memory leak comes ??? Any idea.<br><br>Thanks in Advance.<br>Ana<br> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214858' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214858'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1214858&forumid=18&select=1214858#xx1214858xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1214858#xx1214858xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214858'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214858'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1214053_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1214053xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1214053 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1214053#xx1214053xx'><b>can't see events</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=2189699'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>seher akdeniz</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>8:20 2 Sep '05</b>&nbsp;</font></td></tr>
<tr id=1214053_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I want to see the event handlers and messages of my grid. But I can't.<br>how can i see?<br>thanks... <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214053' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214053'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1214053&forumid=18&select=1214053#xx1214053xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1214053#xx1214053xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214053'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1214053'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1206743_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1206743xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1206743 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1206743#xx1206743xx'><b>How can I insert picture into a cell?</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=1214477'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>qoowater</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>6:08 26 Aug '05</b>&nbsp;</font></td></tr>
<tr id=1206743_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Hello <br>The grid is very good ,especially its performance.<br>but i have some picture need to insert into a cell.  <br>do i need to write a new cell type or it can do that now?<br> thanks <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206743' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206743'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1206743&forumid=18&select=1206743#xx1206743xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1206743#xx1206743xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206743'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206743'><i>Delete</i></a>]<br>Score: 3.5 (2 votes). </td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=6></td></tr><tr bgcolor='#FEF9E7' id=1219436_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1219436xx'></a><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1219436 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1219436#xx1219436xx'>Re: How can I insert picture into a cell?</a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=328801'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle >Yogurt&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle >3:04 8 Sep '05&nbsp;</font></td></tr>
<tr id=1219436_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img height=1 width=18 src='/script/images/ind.gif'><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Have you checked the interfaces?...<br>Hint: search for "image" in *.h <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1219436' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1219436'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1206743&forumid=18&select=1219436#xx1219436xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1219436#xx1219436xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1219436'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1219436'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1206645_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1206645xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1206645 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1206645#xx1206645xx'><b>Accelerator keys don't work</b></a></td></tr></table></td><td valign=bottom><a href='/script/profile/whos_who.asp?id=591137'><img src='/script/images/userinfo.gif' title='Click for User Profile' border=0 width=14 height=15></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>Max Eroshkin</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>3:40 26 Aug '05</b>&nbsp;</font></td></tr>
<tr id=1206645_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>Accelerator keys don't work in CGridCtrl.<br>Why? <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206645' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206645'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1206645&forumid=18&select=1206645#xx1206645xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1206645#xx1206645xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle>[<a href='/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206645'><i>Modify</i></a>|<a href='/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1206645'><i>Delete</i></a>]<br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr><tr height=1><td colspan=4 bgcolor='#ff9900'><img src='/script/images/t.gif' width=1 height=1></td></tr><tr bgcolor='#FEF9E7' id=1205521_h0><td width='70%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td bgcolor=white><a name='xx1205521xx'></a><img align=absmiddle src='/script/images/news_general.gif'>&nbsp;</td>
<td width='100%' class=messagetitle><a class=messagetitle id=DynMessLink name=1205521 href='/miscctrl/gridctrl.asp?df=100&forumid=18&select=1205521#xx1205521xx'><b>Fixed Cell doesn't work, smartly</b></a></td></tr></table></td><td valign=bottom><img src='/script/images/usersuss.gif' alt='Unconfirmed/Anonymous posting' width=15 height=13></a>&nbsp;</td><td width=140 nowrap><font class=messagetitle ><b>Namsu Yi</b>&nbsp;</font></td><td nowrap align=right width='12%'><font class=messagetitle ><b>4:27 25 Aug '05</b>&nbsp;</font></td></tr>
<tr id=1205521_h1 style='display:none' ><td colspan=4 width='100%'><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td><img align=absmiddle src='/script/images/news_blank.gif'>&nbsp;</td><td bgcolor='#D5EAFF' width='100%'><table border=0 cellspacing=5 cellpadding=0 width='100%'><tr><td><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><td colspan=2><font class=messagecontent>I called functions, 'SetFixedRowCount(), SetFixedColumnCount()'.<br>So, The fixed cell was applied. I thought that this function was working very well.<br>But I found that this Grid Control have the problem.<br>This problem ocurred after executing as follows.<br><br>1.Click right mouse button on the cell which is fixed cell.<br>2.And then click left mouse button on same cell.<br>3.Fixed cell is edited.<br><br>If click only left mouse button, this problem is not happend.<br> <br>Why is this problem happend?<br>How does I resolve this problem?<br><br>I need your helps.<br><br><br> <br>&nbsp;</font></td></tr><tr valign=top><td class=messagetitle>[<a href='/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1205521' title='Reply to this current thread'>Reply</a>][<a href='/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&df=100&forumid=18&select=1205521'  title='Email a reply to the author of this message'>Email</a>][<a	href='/miscctrl/gridctrl.asp?df=100&tid=1205521&forumid=18&select=1205521#xx1205521xx' title='View only messages within this thread'>View Thread</a>][<a	href='/miscctrl/gridctrl.asp?msg=1205521#xx1205521xx' title='Get the URL for this message'>Get Link</a>]</td><td align=right class=messagetitle><br></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr><td colspan=4><img src='/script/images/t.gif' border=0 width=1 height=5></td></tr></table></td></tr><tr bgcolor=#FBEDBB><td><table width='100%' cellpadding=2><tr><td class=messagetitle>Last Visit: 15:56 Friday 21st October, 2005</td><td align=right nowrap><font class=messagetitle><span class=HoverLink >First</span> <span class=HoverLink >Prev</span> <a class=HoverLink name=HoverNL href='/miscctrl/gridctrl.asp?df=100&forumid=18&fr=26'>Next</a> <span class=HoverLink >&nbsp;&nbsp;&nbsp;&nbsp;</span> </font></td></tr></table></td></tr></table></td></tr></table>
<p class=smallText><img align=absmiddle src='/script/images/news_general.gif'> General comment &nbsp;&nbsp; <img align=absmiddle src='/script/images/news_info.gif'> News / Info &nbsp;&nbsp; <img align=absmiddle src='/script/images/news_question.gif'> Question &nbsp;&nbsp; <img align=absmiddle src='/script/images/news_answer.gif'> Answer &nbsp;&nbsp; <img align=absmiddle src='/script/images/news_game.gif'> Joke / Game &nbsp;&nbsp; <img align=absmiddle src='/script/images/news_sticky.gif'> Admin message</p>
		<script language=javascript>
		var table = document.getElementById("ForumTable");
		var links = table.getElementsByTagName("a");
		for (var i = 0; i < links.length; i++) {
		    if (links[i].id == "DynMessLink")
		    	links[i].onclick = SwitchThisMessage;
		}
		</script>

<br>


<table width=100% cellspacing=5>
<tr valign=top><td>
<font size=1 style="font-size:7pt"><a href='/?cat=1'>All Topics</a>, <a href='/?cat=2'>MFC / C++</a> &gt;&gt; <a href='/miscctrl/'>Miscellaneous Controls</a> &gt;&gt; <a href='/miscctrl/#Grid+Control'>Grid Control</a>
<br>Updated: 13 Mar 2004 0:00
</font>
</td><td align=right>
<font size=1 style="font-size:7pt">
Article content copyright Chris Maunder, 1999<br>
everything else Copyright © <A href='mailto:webmaster@codeproject.com'>CodeProject</A>, 1999-2005</a>.

<br><a href='/info/MediaKit'>Advertise on The Code Project</a>
	| <a href="/info/privacy.asp">Privacy</a>

</td></tr>
</table>

<br>
<center>
<table border="0" cellspacing="0" cellpadding="0" width="95%">
<tr><td height=1 bgcolor=#ff9900><img src='/images/space.gif' height=1></td></tr>
<tr>
<td align=center><font size=1>

<a href="http://www.theultimatetoolbox.com">The Ultimate Toolbox</a> 
<a href="/redir.asp?id=235">MSDN Communities</a> |
<a href="http://www.ASPAlliance.com/">ASP Alliance</a> 
<a href="http://www.developerfusion.co.uk/">Developer Fusion</a> 
<a href="http://www.developersdex.com/">Developersdex</a> 
<a href="http://www.devguru.com/">DevGuru</a> 
<a href="http://www.programmersheaven.com/">Programmers Heaven</a> 
<A href="http://www.planet-source-code.com/">Planet Source Code</a> 
<a href="http://www.tek-tips.com/">Tek-Tips Forums</a> 

</font>	
</td>
</tr>
</table>
</center>

</body>
</html>
